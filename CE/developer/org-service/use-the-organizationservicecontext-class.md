---
title: Use the OrganizationServiceContext class (Developer Guide for Dynamics 365 for Customer Engagement)| MicrosoftDocs
description: The OrganizationServiceContext class lets you track changes, manage identities and relationships, and gives you access to the Dynamics 365 for Customer Engagement LINQ provider. This class also contains a OrganizationServiceContext.SaveChanges method that you use to submit the changes to data that the context is tracking
ms.custom: ''
ms.date: 12/15/2017
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
- Dynamics 365 for Customer Engagement (online)
ms.assetid: d63562dd-c4fb-40de-82d4-25d7fb4d7553
caps.latest.revision: 51
author: JimDaly
ms.author: jdaly
manager: amyla
search.audienceType:
- developer
search.app:
- D365CE
ms.openlocfilehash: b16fe8e8009704bb295d3a41d7d141db81541755
ms.sourcegitcommit: 9f0efd59de16a6d9902fa372cb25fc0baf1c2838
ms.translationtype: HT
ms.contentlocale: vi-VN
ms.lasthandoff: 01/08/2019
ms.locfileid: "386082"
---
# <a name="use-the-organizationservicecontext-class"></a><span data-ttu-id="2fe3a-104">Use the OrganizationServiceContext class</span><span class="sxs-lookup"><span data-stu-id="2fe3a-104">Use the OrganizationServiceContext class</span></span>

[!INCLUDE[](../../includes/cc_applies_to_update_9_0_0.md)]

<span data-ttu-id="2fe3a-105">In [!INCLUDE[pn_dynamics_crm_online](../../includes/pn-dynamics-crm-online.md)] apps, you can use the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceProxy> class to access the Web services.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-105">In [!INCLUDE[pn_dynamics_crm_online](../../includes/pn-dynamics-crm-online.md)] apps, you can use the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceProxy> class to access the Web services.</span></span> <span data-ttu-id="2fe3a-106">Alternatively, you can use the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext> generated by the code generation tool to gain access to additional functionality.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-106">Alternatively, you can use the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext> generated by the code generation tool to gain access to additional functionality.</span></span> <span data-ttu-id="2fe3a-107">The `OrganizationServiceContext` class lets you track changes, manage identities and relationships, and gives you access to the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps LINQ provider.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-107">The `OrganizationServiceContext` class lets you track changes, manage identities and relationships, and gives you access to the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps LINQ provider.</span></span> <span data-ttu-id="2fe3a-108">This class also contains a <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges></span><span class="sxs-lookup"><span data-stu-id="2fe3a-108">This class also contains a <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges></span></span> <span data-ttu-id="2fe3a-109">method that you use to submit the changes to data that the context is tracking.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-109">method that you use to submit the changes to data that the context is tracking.</span></span> <span data-ttu-id="2fe3a-110">This class is based on the same concept as the [DataServiceContext](https://msdn.microsoft.com/library/cc679618.aspx) class in [!INCLUDE[pn_WCF_long](../../includes/pn-wcf-long.md)] Data Services.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-110">This class is based on the same concept as the [DataServiceContext](https://msdn.microsoft.com/library/cc679618.aspx) class in [!INCLUDE[pn_WCF_long](../../includes/pn-wcf-long.md)] Data Services.</span></span>  

 <span data-ttu-id="2fe3a-111">To generate this class, provide a value for the `/serviceContextName` parameter when you generate early bound types.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-111">To generate this class, provide a value for the `/serviceContextName` parameter when you generate early bound types.</span></span> <span data-ttu-id="2fe3a-112">The code generation tool uses this name as the name of the generated class.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-112">The code generation tool uses this name as the name of the generated class.</span></span> <span data-ttu-id="2fe3a-113">For more information about how to use the code generation tool, see [Use the Code Generation Utility (CrmSvcUtil.exe)](create-early-bound-entity-classes-code-generation-tool.md).</span><span class="sxs-lookup"><span data-stu-id="2fe3a-113">For more information about how to use the code generation tool, see [Use the Code Generation Utility (CrmSvcUtil.exe)](create-early-bound-entity-classes-code-generation-tool.md).</span></span> <span data-ttu-id="2fe3a-114">You can use the organization service context when you develop applications, plug-ins, and workflow activities.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-114">You can use the organization service context when you develop applications, plug-ins, and workflow activities.</span></span>  

<a name="how_to_use"></a>
## <a name="how-to-use-the-organizationservicecontext-class"></a><span data-ttu-id="2fe3a-115">How to use the OrganizationServiceContext class</span><span class="sxs-lookup"><span data-stu-id="2fe3a-115">How to use the OrganizationServiceContext class</span></span>  
 <span data-ttu-id="2fe3a-116">To instantiate the context class, you must pass the class constructor an object that implements the <xref:Microsoft.Xrm.Sdk.IOrganizationService> interface.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-116">To instantiate the context class, you must pass the class constructor an object that implements the <xref:Microsoft.Xrm.Sdk.IOrganizationService> interface.</span></span> <span data-ttu-id="2fe3a-117">One option is to pass an instance of the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceProxy> class.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-117">One option is to pass an instance of the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceProxy> class.</span></span> <span data-ttu-id="2fe3a-118">For more information about the<xref:Microsoft.Xrm.Sdk.IOrganizationService> interface, see [Use IOrganizationService for Your Organization](use-organization-service-read-write-data-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="2fe3a-118">For more information about the<xref:Microsoft.Xrm.Sdk.IOrganizationService> interface, see [Use IOrganizationService for Your Organization](use-organization-service-read-write-data-metadata.md).</span></span>

 <span data-ttu-id="2fe3a-119">The following code example shows how to create a new instance of the context class.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-119">The following code example shows how to create a new instance of the context class.</span></span> <span data-ttu-id="2fe3a-120">In this example, the context class was named AdventureWorksCycleServiceContext by specifying the name using the `/serviceContextName` parameter on the code generation tool:</span><span class="sxs-lookup"><span data-stu-id="2fe3a-120">In this example, the context class was named AdventureWorksCycleServiceContext by specifying the name using the `/serviceContextName` parameter on the code generation tool:</span></span>  

```csharp  
//For early bound types to work correctly, they have to be enabled on the proxy.  
_serviceProxy.EnableProxyTypes();  
AdventureWorksCycleServiceContext context = new AdventureWorksCycleServiceContext(_serviceProxy);  
```  

 <span data-ttu-id="2fe3a-121">After you create the organization service context object, you can begin to track create, modify, or delete entities.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-121">After you create the organization service context object, you can begin to track create, modify, or delete entities.</span></span> <span data-ttu-id="2fe3a-122">For example, the following code example shows how to instantiate a new contact, and then save it to a [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps server by using the service context object.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-122">For example, the following code example shows how to instantiate a new contact, and then save it to a [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps server by using the service context object.</span></span>  

```csharp  
//  Create a new contact record;  
AdventureWorksCycleServiceContext context = new AdventureWorksCycleServiceContext (_serviceProxy);  
Contact contact = new Contact()   
 {  
   FirstName = "Pamela",  
   LastName = "Brown",  
   Address1_Line1 = "123 Easy St.",  
   Address1_City = "Atlanta",  
   Address1_StateOrProvince = "GA",  
   Address1_PostalCode = "32254",  
   Telephone1 = "425-555-5678"   };  
context.AddObject(contact);  
context.SaveChanges();  
```  

 <span data-ttu-id="2fe3a-123">There are several points to note in the previous code example.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-123">There are several points to note in the previous code example.</span></span> <span data-ttu-id="2fe3a-124">First, after a new contact is instantiated, you pass that contact object to the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddObject(Microsoft.Xrm.Sdk.Entity)></span><span class="sxs-lookup"><span data-stu-id="2fe3a-124">First, after a new contact is instantiated, you pass that contact object to the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddObject(Microsoft.Xrm.Sdk.Entity)></span></span> <span data-ttu-id="2fe3a-125">method so the context can begin tracking the object.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-125">method so the context can begin tracking the object.</span></span> <span data-ttu-id="2fe3a-126">The second point to note is that the new object is saved to the server by using the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges></span><span class="sxs-lookup"><span data-stu-id="2fe3a-126">The second point to note is that the new object is saved to the server by using the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges></span></span> <span data-ttu-id="2fe3a-127">method.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-127">method.</span></span>  

 <span data-ttu-id="2fe3a-128">The organization service context must track any entity or relationship that you want to submit to [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-128">The organization service context must track any entity or relationship that you want to submit to [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps.</span></span> <span data-ttu-id="2fe3a-129">For example, you could retrieve a record with a LINQ query and the context would track that entity or you could use the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.Attach(Microsoft.Xrm.Sdk.Entity)></span><span class="sxs-lookup"><span data-stu-id="2fe3a-129">For example, you could retrieve a record with a LINQ query and the context would track that entity or you could use the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.Attach(Microsoft.Xrm.Sdk.Entity)></span></span> <span data-ttu-id="2fe3a-130">method to cause the context to begin tracking the entity.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-130">method to cause the context to begin tracking the entity.</span></span> <span data-ttu-id="2fe3a-131">You can work with data in a client application and create new entities, create related entities, and modify existing entities, but you must call the `SaveChanges` method on tracked entities to commit changes to the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps server.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-131">You can work with data in a client application and create new entities, create related entities, and modify existing entities, but you must call the `SaveChanges` method on tracked entities to commit changes to the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps server.</span></span>  

<a name="track_changes"></a>   
## <a name="track-changes-with-the-organizationservicecontext-class"></a><span data-ttu-id="2fe3a-132">Track changes with the OrganizationServiceContext class</span><span class="sxs-lookup"><span data-stu-id="2fe3a-132">Track changes with the OrganizationServiceContext class</span></span>  
 <span data-ttu-id="2fe3a-133">To determine how an entity is tracked by the context, you can check the <xref:Microsoft.Xrm.Sdk.Entity.EntityState> property on the entity instance.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-133">To determine how an entity is tracked by the context, you can check the <xref:Microsoft.Xrm.Sdk.Entity.EntityState> property on the entity instance.</span></span> <span data-ttu-id="2fe3a-134">You must notify the organization service context to track an entity from [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps by calling various methods or by using a LINQ query.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-134">You must notify the organization service context to track an entity from [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps by calling various methods or by using a LINQ query.</span></span> <span data-ttu-id="2fe3a-135">All entities returned from a [!INCLUDE[pn_LINQ](../../includes/pn-linq.md)] query are tracked by the service context.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-135">All entities returned from a [!INCLUDE[pn_LINQ](../../includes/pn-linq.md)] query are tracked by the service context.</span></span>  

 <span data-ttu-id="2fe3a-136">You can add objects to the service context by calling one of the following methods in <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-136">You can add objects to the service context by calling one of the following methods in <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.</span></span>  

|<span data-ttu-id="2fe3a-137">Phương pháp</span><span class="sxs-lookup"><span data-stu-id="2fe3a-137">Method</span></span>|<span data-ttu-id="2fe3a-138">Sử dụng</span><span class="sxs-lookup"><span data-stu-id="2fe3a-138">Use</span></span>|  
|------------|---------|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddObject(Microsoft.Xrm.Sdk.Entity)>|<span data-ttu-id="2fe3a-139">Adds an entity to the set of entities the organization service context is tracking.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-139">Adds an entity to the set of entities the organization service context is tracking.</span></span> <span data-ttu-id="2fe3a-140">The status of the entity in the context is set to `Created`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-140">The status of the entity in the context is set to `Created`.</span></span> <span data-ttu-id="2fe3a-141">If the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges> method is called, this record will be created or added to the server.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-141">If the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges> method is called, this record will be created or added to the server.</span></span>|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.Attach(Microsoft.Xrm.Sdk.Entity)>|<span data-ttu-id="2fe3a-142">Adds an entity to the set of entities the organization service context is tracking.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-142">Adds an entity to the set of entities the organization service context is tracking.</span></span> <span data-ttu-id="2fe3a-143">The status of the entity in the context is set to `Unchanged`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-143">The status of the entity in the context is set to `Unchanged`.</span></span> <span data-ttu-id="2fe3a-144">If the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges> method is called, this entity will not be sent to the server unless its status changes.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-144">If the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges> method is called, this entity will not be sent to the server unless its status changes.</span></span>|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.CreateQuery(System.String)>|<span data-ttu-id="2fe3a-145">Adds the results of a query to the set of entities the organization service context is tracking.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-145">Adds the results of a query to the set of entities the organization service context is tracking.</span></span>|  

<a name="track_related"></a>   
## <a name="track-related-objects-with-the-organizationservicecontext-class"></a><span data-ttu-id="2fe3a-146">Track related objects with the OrganizationServiceContext class</span><span class="sxs-lookup"><span data-stu-id="2fe3a-146">Track related objects with the OrganizationServiceContext class</span></span>  
 <span data-ttu-id="2fe3a-147">In [!INCLUDE[pn_crm_shortest](../../includes/pn-crm-shortest.md)] apps and [!INCLUDE[pn_crm_online_shortest](../../includes/pn-crm-online-shortest.md)], the organization service context lets you create and update relationships between entities.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-147">In [!INCLUDE[pn_crm_shortest](../../includes/pn-crm-shortest.md)] apps and [!INCLUDE[pn_crm_online_shortest](../../includes/pn-crm-online-shortest.md)], the organization service context lets you create and update relationships between entities.</span></span> <span data-ttu-id="2fe3a-148">The navigation properties generated by the [!INCLUDE[sdk_CodeGenUtility](../../includes/sdk-codegenutility.md)] tool and located in the early-bound classes let you access and change related entity properties and relationships.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-148">The navigation properties generated by the [!INCLUDE[sdk_CodeGenUtility](../../includes/sdk-codegenutility.md)] tool and located in the early-bound classes let you access and change related entity properties and relationships.</span></span> <span data-ttu-id="2fe3a-149">The organization service context must be tracking the related entity for the related entity to be available to be updated on the server.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-149">The organization service context must be tracking the related entity for the related entity to be available to be updated on the server.</span></span>  

 <span data-ttu-id="2fe3a-150">Use the following methods in <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext> to work with related entities and to add the entity to the service context:</span><span class="sxs-lookup"><span data-stu-id="2fe3a-150">Use the following methods in <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext> to work with related entities and to add the entity to the service context:</span></span>  

|<span data-ttu-id="2fe3a-151">Phương pháp</span><span class="sxs-lookup"><span data-stu-id="2fe3a-151">Method</span></span>|<span data-ttu-id="2fe3a-152">Sử dụng</span><span class="sxs-lookup"><span data-stu-id="2fe3a-152">Use</span></span>|  
|------------|---------|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddRelatedObject(Microsoft.Xrm.Sdk.Entity,Microsoft.Xrm.Sdk.Relationship,Microsoft.Xrm.Sdk.Entity)>|<span data-ttu-id="2fe3a-153">Adds the target to the context.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-153">Adds the target to the context.</span></span> <span data-ttu-id="2fe3a-154">Calls the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.Attach(Microsoft.Xrm.Sdk.Entity)> method on the target entity and then calls the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddLink(Microsoft.Xrm.Sdk.Entity,Microsoft.Xrm.Sdk.Relationship,Microsoft.Xrm.Sdk.Entity)> method between the source entity and the target (related) entity.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-154">Calls the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.Attach(Microsoft.Xrm.Sdk.Entity)> method on the target entity and then calls the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddLink(Microsoft.Xrm.Sdk.Entity,Microsoft.Xrm.Sdk.Relationship,Microsoft.Xrm.Sdk.Entity)> method between the source entity and the target (related) entity.</span></span>|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AttachLink(Microsoft.Xrm.Sdk.Entity,Microsoft.Xrm.Sdk.Relationship,Microsoft.Xrm.Sdk.Entity)>|<span data-ttu-id="2fe3a-155">Adds the related entity to the context for tracking.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-155">Adds the related entity to the context for tracking.</span></span> <span data-ttu-id="2fe3a-156">The status of the entity in the context is set to `Unchanged`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-156">The status of the entity in the context is set to `Unchanged`.</span></span>|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddLink(Microsoft.Xrm.Sdk.Entity,Microsoft.Xrm.Sdk.Relationship,Microsoft.Xrm.Sdk.Entity)>|<span data-ttu-id="2fe3a-157">Creates a relationship between the source and target entities.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-157">Creates a relationship between the source and target entities.</span></span> <span data-ttu-id="2fe3a-158">Adds the target to the context.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-158">Adds the target to the context.</span></span> <span data-ttu-id="2fe3a-159">The status of the target entity in the context is set to `Created`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-159">The status of the target entity in the context is set to `Created`.</span></span>|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.LoadProperty(Microsoft.Xrm.Sdk.Entity,System.String)>|<span data-ttu-id="2fe3a-160">Loads the related entity set for the specified relationship.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-160">Loads the related entity set for the specified relationship.</span></span> <span data-ttu-id="2fe3a-161">Gives access to related entities by using the navigation property.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-161">Gives access to related entities by using the navigation property.</span></span> <span data-ttu-id="2fe3a-162">Call the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddObject(Microsoft.Xrm.Sdk.Entity)> method on the related entity after you have accessed the entity by using a navigation property on the parent entity.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-162">Call the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.AddObject(Microsoft.Xrm.Sdk.Entity)> method on the related entity after you have accessed the entity by using a navigation property on the parent entity.</span></span>|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.UpdateObject(Microsoft.Xrm.Sdk.Entity)>|<span data-ttu-id="2fe3a-163">Changes the state of the specified entity in the `OrganizationServiceContext` to Modified.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-163">Changes the state of the specified entity in the `OrganizationServiceContext` to Modified.</span></span>|  
|<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.DeleteObject(Microsoft.Xrm.Sdk.Entity)>|<span data-ttu-id="2fe3a-164">Changes the state of the specified entity to be deleted in the `OrganizationServiceContext`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-164">Changes the state of the specified entity to be deleted in the `OrganizationServiceContext`.</span></span>|  

<a name="BKMK_LoadRelatedEntities"></a>   
### <a name="load-related-entities-using-navigation-properties"></a><span data-ttu-id="2fe3a-165">Load related entities using navigation properties</span><span class="sxs-lookup"><span data-stu-id="2fe3a-165">Load related entities using navigation properties</span></span>  
 <span data-ttu-id="2fe3a-166">Related entities for entities you have retrieved using LINQ will be null until you use <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.LoadProperty(Microsoft.Xrm.Sdk.Entity,Microsoft.Xrm.Sdk.Relationship)> to retrieve them.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-166">Related entities for entities you have retrieved using LINQ will be null until you use <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.LoadProperty(Microsoft.Xrm.Sdk.Entity,Microsoft.Xrm.Sdk.Relationship)> to retrieve them.</span></span> <span data-ttu-id="2fe3a-167">The following code sample shows how to access Task records associated with a specific Contact record.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-167">The following code sample shows how to access Task records associated with a specific Contact record.</span></span>  

```csharp  
Contact pam = context.ContactSet.Where(c => c.FirstName == "Pamela").FirstOrDefault();  
if (pam != null)  
{  
// pam.Contact_Tasks is null until you use LoadProperty  
    context.LoadProperty(pam, "Contact_Tasks");  
    Task firstTask = pam.Contact_Tasks.FirstOrDefault();  
}  
```  

<a name="save_changes"></a>   
## <a name="save-changes-with-the-organizationservicecontext-class"></a><span data-ttu-id="2fe3a-168">Save changes with the OrganizationServiceContext class</span><span class="sxs-lookup"><span data-stu-id="2fe3a-168">Save changes with the OrganizationServiceContext class</span></span>  
 <span data-ttu-id="2fe3a-169">The organization service context holds a graph of the entities it is tracking.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-169">The organization service context holds a graph of the entities it is tracking.</span></span> <span data-ttu-id="2fe3a-170">The order in which the organization service context processes entity changes and submits them to the server is important.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-170">The order in which the organization service context processes entity changes and submits them to the server is important.</span></span> <span data-ttu-id="2fe3a-171">Updates to primary entity are processed, and then related entities are processed.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-171">Updates to primary entity are processed, and then related entities are processed.</span></span> <span data-ttu-id="2fe3a-172">If a value is set on the primary entity by the related entity, that value is used when updating data on the server.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-172">If a value is set on the primary entity by the related entity, that value is used when updating data on the server.</span></span>  

 <span data-ttu-id="2fe3a-173">If an error occurs when entity information is being saved, a new exception type that contains the <xref:Microsoft.Xrm.Sdk.SaveChangesResult> is thrown by the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges></span><span class="sxs-lookup"><span data-stu-id="2fe3a-173">If an error occurs when entity information is being saved, a new exception type that contains the <xref:Microsoft.Xrm.Sdk.SaveChangesResult> is thrown by the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.<xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.SaveChanges></span></span> <span data-ttu-id="2fe3a-174">method, regardless of the value of the <xref:Microsoft.Xrm.Sdk.Client.SaveChangesOptions> parameter that is passed into the method.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-174">method, regardless of the value of the <xref:Microsoft.Xrm.Sdk.Client.SaveChangesOptions> parameter that is passed into the method.</span></span>  

<a name="virtual"></a>   
## <a name="use-virtual-methods-when-the-context-is-changed"></a><span data-ttu-id="2fe3a-175">Use virtual methods when the context is changed</span><span class="sxs-lookup"><span data-stu-id="2fe3a-175">Use virtual methods when the context is changed</span></span>  
 <span data-ttu-id="2fe3a-176">Sometimes it may be necessary to take actions based on changes in the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-176">Sometimes it may be necessary to take actions based on changes in the <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>.</span></span> <span data-ttu-id="2fe3a-177">To facilitate this, virtual methods are provided to allow you to intercept or be notified of an operation.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-177">To facilitate this, virtual methods are provided to allow you to intercept or be notified of an operation.</span></span> <span data-ttu-id="2fe3a-178">To take advantage of these methods, you either have to derive from <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext> or change the generated organization service context.The following table lists the virtual methods.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-178">To take advantage of these methods, you either have to derive from <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext> or change the generated organization service context.The following table lists the virtual methods.</span></span>  


|                                                                              <span data-ttu-id="2fe3a-179">Phương pháp</span><span class="sxs-lookup"><span data-stu-id="2fe3a-179">Method</span></span>                                                                              |                                                                                       <span data-ttu-id="2fe3a-180">Mô tả</span><span class="sxs-lookup"><span data-stu-id="2fe3a-180">Description</span></span>                                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                            <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.OnBeginEntityTracking(Microsoft.Xrm.Sdk.Entity)>                            |                                                         <span data-ttu-id="2fe3a-181">Called after an entity is attached to the `OrganizationServiceContext`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-181">Called after an entity is attached to the `OrganizationServiceContext`.</span></span>                                                          |
| <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.OnBeginLinkTracking(Microsoft.Xrm.Sdk.Entity,Microsoft.Xrm.Sdk.Relationship,Microsoft.Xrm.Sdk.Entity)> |                                                           <span data-ttu-id="2fe3a-182">Called after a link is attached to the `OrganizationServiceContext`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-182">Called after a link is attached to the `OrganizationServiceContext`.</span></span>                                                           |
|                             <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.OnEndEntityTracking(Microsoft.Xrm.Sdk.Entity)>                             |                                                        <span data-ttu-id="2fe3a-183">Called after an entity is detached from the `OrganizationServiceContext`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-183">Called after an entity is detached from the `OrganizationServiceContext`.</span></span>                                                         |
|                             <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.OnEndEntityTracking(Microsoft.Xrm.Sdk.Entity)>                             |                                                          <span data-ttu-id="2fe3a-184">Called after a link is detached from the `OrganizationServiceContext`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-184">Called after a link is detached from the `OrganizationServiceContext`.</span></span>                                                          |
|                          <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.OnExecuting(Microsoft.Xrm.Sdk.OrganizationRequest)>                           |                          <span data-ttu-id="2fe3a-185">Called immediately before a request is submitted to the [!INCLUDE[pn_microsoftcrm_server](../../includes/pn-microsoftcrm-server.md)].</span><span class="sxs-lookup"><span data-stu-id="2fe3a-185">Called immediately before a request is submitted to the [!INCLUDE[pn_microsoftcrm_server](../../includes/pn-microsoftcrm-server.md)].</span></span>                           |
|        <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.OnExecute(Microsoft.Xrm.Sdk.OrganizationRequest,Microsoft.Xrm.Sdk.OrganizationResponse)>        | <span data-ttu-id="2fe3a-186">Called immediately after a request is submitted to the [!INCLUDE[pn_microsoftcrm_server](../../includes/pn-microsoftcrm-server.md)], regardless of whether an exception occurred or not.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-186">Called immediately after a request is submitted to the [!INCLUDE[pn_microsoftcrm_server](../../includes/pn-microsoftcrm-server.md)], regardless of whether an exception occurred or not.</span></span> |
|                     <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.OnSavingChanges(Microsoft.Xrm.Sdk.Client.SaveChangesOptions)>                      |                                                            <span data-ttu-id="2fe3a-187">Called before any operations occur after a call to `SaveChanges`.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-187">Called before any operations occur after a call to `SaveChanges`.</span></span>                                                             |
|                     <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext.OnSaveChanges(Microsoft.Xrm.Sdk.SaveChangesResultCollection)>                      |                                        <span data-ttu-id="2fe3a-188">Called when all of the operations for a call to `SaveChanges` have completed, or when there is a failure.</span><span class="sxs-lookup"><span data-stu-id="2fe3a-188">Called when all of the operations for a call to `SaveChanges` have completed, or when there is a failure.</span></span>                                         |

### <a name="see-also"></a><span data-ttu-id="2fe3a-189">Xem thêm</span><span class="sxs-lookup"><span data-stu-id="2fe3a-189">See also</span></span>  
 <span data-ttu-id="2fe3a-190">[Use the Early Bound Entity Classes in Code](use-early-bound-entity-classes-code.md) </span><span class="sxs-lookup"><span data-stu-id="2fe3a-190">[Use the Early Bound Entity Classes in Code](use-early-bound-entity-classes-code.md) </span></span>  
 <span data-ttu-id="2fe3a-191">[Sample: LINQ Query Examples for Dynamics 365 for Customer Engagement apps](sample-complex-linq-queries.md) </span><span class="sxs-lookup"><span data-stu-id="2fe3a-191">[Sample: LINQ Query Examples for Dynamics 365 for Customer Engagement apps](sample-complex-linq-queries.md) </span></span>  
 <span data-ttu-id="2fe3a-192">[Using the Code Generation Utility (CrmSvcUtil.exe)](create-early-bound-entity-classes-code-generation-tool.md) </span><span class="sxs-lookup"><span data-stu-id="2fe3a-192">[Using the Code Generation Utility (CrmSvcUtil.exe)](create-early-bound-entity-classes-code-generation-tool.md) </span></span>  
 <span data-ttu-id="2fe3a-193">[Use the Early Bound Entity Classes for Create, Update and Delete](use-early-bound-entity-classes-create-update-delete.md) </span><span class="sxs-lookup"><span data-stu-id="2fe3a-193">[Use the Early Bound Entity Classes for Create, Update and Delete](use-early-bound-entity-classes-create-update-delete.md) </span></span>  
<xref:Microsoft.Xrm.Sdk.IOrganizationService>   
 <xref:Microsoft.Xrm.Sdk.Client.OrganizationServiceContext>
