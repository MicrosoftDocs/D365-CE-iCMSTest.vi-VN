---
title: 'Sample: Use optimistic concurrency with update and delete operations (Developer Guide for Dynamics 365 for Customer Engagement)| MicrosoftDocs'
description: This sample shows how to use optimistic concurrency for update and delete operations
ms.custom: ''
ms.date: 12/05/2017
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: samples
applies_to:
- Dynamics 365 for Customer Engagement (online)
ms.assetid: da409f14-86aa-4fb4-b669-e37629a60ae0
caps.latest.revision: 16
author: JimDaly
ms.author: jdaly
manager: amyla
search.audienceType:
- developer
search.app:
- D365CE
ms.openlocfilehash: f6a13890ba4c127d67a4202fc44946724b0d8ee9
ms.sourcegitcommit: 9f0efd59de16a6d9902fa372cb25fc0baf1c2838
ms.translationtype: HT
ms.contentlocale: vi-VN
ms.lasthandoff: 01/08/2019
ms.locfileid: "387051"
---
# <a name="sample-use-optimistic-concurrency-with-update-and-delete-operations"></a><span data-ttu-id="02516-103">Sample: Use optimistic concurrency with update and delete operations</span><span class="sxs-lookup"><span data-stu-id="02516-103">Sample: Use optimistic concurrency with update and delete operations</span></span>

[!INCLUDE[](../../includes/cc_applies_to_update_9_0_0.md)]

<span data-ttu-id="02516-104">Demonstrates how to use the optimistic concurrency feature, introduced in [!INCLUDE[pn_crm_online_2015_update_1](../../includes/pn-crm-online-2015-update-1.md)], to prevent potential data loss when doing an update or delete of entity records.</span><span class="sxs-lookup"><span data-stu-id="02516-104">Demonstrates how to use the optimistic concurrency feature, introduced in [!INCLUDE[pn_crm_online_2015_update_1](../../includes/pn-crm-online-2015-update-1.md)], to prevent potential data loss when doing an update or delete of entity records.</span></span> <span data-ttu-id="02516-105">For more details about the technique used, refer to this topic: [Reduce potential data loss using optimistic concurrency](reduce-potential-data-loss-using-optimistic-concurrency.md)</span><span class="sxs-lookup"><span data-stu-id="02516-105">For more details about the technique used, refer to this topic: [Reduce potential data loss using optimistic concurrency](reduce-potential-data-loss-using-optimistic-concurrency.md)</span></span>  

 <span data-ttu-id="02516-106">The complete sample can be downloaded at [Use optimistic concurrency with update and delete operations](https://code.msdn.microsoft.com/Use-optimistic-concurrency-e0b0440d).</span><span class="sxs-lookup"><span data-stu-id="02516-106">The complete sample can be downloaded at [Use optimistic concurrency with update and delete operations](https://code.msdn.microsoft.com/Use-optimistic-concurrency-e0b0440d).</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="02516-107">Điều kiện tiên quyết</span><span class="sxs-lookup"><span data-stu-id="02516-107">Prerequisites</span></span>  
 <span data-ttu-id="02516-108">To run this sample you must have:</span><span class="sxs-lookup"><span data-stu-id="02516-108">To run this sample you must have:</span></span>  

- <span data-ttu-id="02516-109">Access to a [!INCLUDE[pn_crm_online_2016_update](../../includes/pn-crm-online-2016-update.md)] or [!INCLUDE[pn_crm_2016](../../includes/pn-crm-2016.md)] on-premises organization.</span><span class="sxs-lookup"><span data-stu-id="02516-109">Access to a [!INCLUDE[pn_crm_online_2016_update](../../includes/pn-crm-online-2016-update.md)] or [!INCLUDE[pn_crm_2016](../../includes/pn-crm-2016.md)] on-premises organization.</span></span>  

- [!INCLUDE[pn_NET_Framework_452_long](../../includes/pn-net-framework-452-long.md)] <span data-ttu-id="02516-110">installed on your development computer.</span><span class="sxs-lookup"><span data-stu-id="02516-110">installed on your development computer.</span></span>  

- <span data-ttu-id="02516-111">An active Internet connection for the required [!INCLUDE[tn_nuget](../../includes/tn-nuget.md)] packages to automatically download when building the sample.</span><span class="sxs-lookup"><span data-stu-id="02516-111">An active Internet connection for the required [!INCLUDE[tn_nuget](../../includes/tn-nuget.md)] packages to automatically download when building the sample.</span></span>  

<a name="BKMK_WhatThisSampleDoes"></a>   
## <a name="what-this-sample-does"></a><span data-ttu-id="02516-112">What this sample does</span><span class="sxs-lookup"><span data-stu-id="02516-112">What this sample does</span></span>  
 <span data-ttu-id="02516-113">This sample shows how to use optimistic concurrency for update and delete operations.</span><span class="sxs-lookup"><span data-stu-id="02516-113">This sample shows how to use optimistic concurrency for update and delete operations.</span></span> <span data-ttu-id="02516-114">Code snippets showing just the key sections of the sample are shown.</span><span class="sxs-lookup"><span data-stu-id="02516-114">Code snippets showing just the key sections of the sample are shown.</span></span> <span data-ttu-id="02516-115">This sample sets the concurrency behavior on the update and delete requests so the server will check for a specific version of an account record for those operations.</span><span class="sxs-lookup"><span data-stu-id="02516-115">This sample sets the concurrency behavior on the update and delete requests so the server will check for a specific version of an account record for those operations.</span></span> <span data-ttu-id="02516-116">If the update or delete operations are attempted using a record with a different row version, an exception results.</span><span class="sxs-lookup"><span data-stu-id="02516-116">If the update or delete operations are attempted using a record with a different row version, an exception results.</span></span> <span data-ttu-id="02516-117">Otherwise, the operation is successful.</span><span class="sxs-lookup"><span data-stu-id="02516-117">Otherwise, the operation is successful.</span></span>  

 [!code-csharp[OptimisticConcurrency#UpdateAndDelete1](../../snippets/csharp/CRMV8/optimisticconcurrency/cs/updateanddelete1.cs#updateanddelete1)]  

 [!code-csharp[OptimisticConcurrency#UpdateAndDelete2](../../snippets/csharp/CRMV8/optimisticconcurrency/cs/updateanddelete2.cs#updateanddelete2)]  

<a name="BKMK_installNuget"></a>   
## <a name="install-nuget-packages"></a><span data-ttu-id="02516-118">Install NuGet packages</span><span class="sxs-lookup"><span data-stu-id="02516-118">Install NuGet packages</span></span>  

1. <span data-ttu-id="02516-119">Download this sample and extract the files.</span><span class="sxs-lookup"><span data-stu-id="02516-119">Download this sample and extract the files.</span></span>  

2. <span data-ttu-id="02516-120">Navigate to the C# folder and open the solution file in [!INCLUDE[pn_Visual_Studio](../../includes/pn-visual-studio.md)].</span><span class="sxs-lookup"><span data-stu-id="02516-120">Navigate to the C# folder and open the solution file in [!INCLUDE[pn_Visual_Studio](../../includes/pn-visual-studio.md)].</span></span>  

3. <span data-ttu-id="02516-121">In **Solution Explorer**, right-click the project and click **Manage NuGet Packages**.</span><span class="sxs-lookup"><span data-stu-id="02516-121">In **Solution Explorer**, right-click the project and click **Manage NuGet Packages**.</span></span>  

4. <span data-ttu-id="02516-122">In the drop down list at the top of the dialog, click **Include Prerelease** if you’re using a [!INCLUDE[pn_CRM_Online](../../includes/pn-crm-online.md)] Preview organization.</span><span class="sxs-lookup"><span data-stu-id="02516-122">In the drop down list at the top of the dialog, click **Include Prerelease** if you’re using a [!INCLUDE[pn_CRM_Online](../../includes/pn-crm-online.md)] Preview organization.</span></span> <span data-ttu-id="02516-123">Otherwise, click **Stable Only**.</span><span class="sxs-lookup"><span data-stu-id="02516-123">Otherwise, click **Stable Only**.</span></span>  

5. <span data-ttu-id="02516-124">Close the dialog.</span><span class="sxs-lookup"><span data-stu-id="02516-124">Close the dialog.</span></span>  

   <span data-ttu-id="02516-125">The required packages are automatically installed when you build the solution.</span><span class="sxs-lookup"><span data-stu-id="02516-125">The required packages are automatically installed when you build the solution.</span></span>  

<a name="BKMK_runSample"></a>   
## <a name="run-the-sample"></a><span data-ttu-id="02516-126">Run the sample</span><span class="sxs-lookup"><span data-stu-id="02516-126">Run the sample</span></span>  

1. <span data-ttu-id="02516-127">In [!INCLUDE[pn_Visual_Studio_short](../../includes/pn-visual-studio-short.md)], press F5 to build and run the sample.</span><span class="sxs-lookup"><span data-stu-id="02516-127">In [!INCLUDE[pn_Visual_Studio_short](../../includes/pn-visual-studio-short.md)], press F5 to build and run the sample.</span></span> <span data-ttu-id="02516-128">You’ll be prompted to accept the licenses for the [!INCLUDE[tn_nuget](../../includes/tn-nuget.md)] packages that are to be installed.</span><span class="sxs-lookup"><span data-stu-id="02516-128">You’ll be prompted to accept the licenses for the [!INCLUDE[tn_nuget](../../includes/tn-nuget.md)] packages that are to be installed.</span></span>  

2. <span data-ttu-id="02516-129">If you haven’t previously run one of the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] Customer Engagement managed code samples before, you’ll need to enter information to run the code.</span><span class="sxs-lookup"><span data-stu-id="02516-129">If you haven’t previously run one of the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] Customer Engagement managed code samples before, you’ll need to enter information to run the code.</span></span> <span data-ttu-id="02516-130">Otherwise, enter the number for one of the [!INCLUDE[pn_crm_shortest](../../includes/pn-crm-shortest.md)] servers you have previously set up.</span><span class="sxs-lookup"><span data-stu-id="02516-130">Otherwise, enter the number for one of the [!INCLUDE[pn_crm_shortest](../../includes/pn-crm-shortest.md)] servers you have previously set up.</span></span>  


   |                                                          <span data-ttu-id="02516-131">Prompt</span><span class="sxs-lookup"><span data-stu-id="02516-131">Prompt</span></span>                                                          |                                                                                                                                                                                        <span data-ttu-id="02516-132">Mô tả</span><span class="sxs-lookup"><span data-stu-id="02516-132">Description</span></span>                                                                                                                                                                                        |
   |--------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |      <span data-ttu-id="02516-133">Enter a [!INCLUDE[pn_crm_shortest](../../includes/pn-crm-shortest.md)] server name and port [crm.dynamics.com]</span><span class="sxs-lookup"><span data-stu-id="02516-133">Enter a [!INCLUDE[pn_crm_shortest](../../includes/pn-crm-shortest.md)] server name and port [crm.dynamics.com]</span></span>      | <span data-ttu-id="02516-134">Type the name of your [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] server.</span><span class="sxs-lookup"><span data-stu-id="02516-134">Type the name of your [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] server.</span></span> <span data-ttu-id="02516-135">The default is [!INCLUDE[pn_CRM_Online](../../includes/pn-crm-online.md)] (crm.dynamics.com) in North America.</span><span class="sxs-lookup"><span data-stu-id="02516-135">The default is [!INCLUDE[pn_CRM_Online](../../includes/pn-crm-online.md)] (crm.dynamics.com) in North America.</span></span><br /><br /> <span data-ttu-id="02516-136">Ví dụ: </span><span class="sxs-lookup"><span data-stu-id="02516-136">Example:</span></span> <br /><span data-ttu-id="02516-137">crm5.dynamics.com</span><span class="sxs-lookup"><span data-stu-id="02516-137">crm5.dynamics.com</span></span><br /><br /> <span data-ttu-id="02516-138">Don’t include the name of your organization or Internet protocol (http or https).</span><span class="sxs-lookup"><span data-stu-id="02516-138">Don’t include the name of your organization or Internet protocol (http or https).</span></span> <span data-ttu-id="02516-139">You’ll be prompted for that later.</span><span class="sxs-lookup"><span data-stu-id="02516-139">You’ll be prompted for that later.</span></span> |
   | <span data-ttu-id="02516-140">Is this organization provisioned in [!INCLUDE[pn_MS_Online_Services](../../includes/pn-ms-online-services.md)] (y/n) [n]</span><span class="sxs-lookup"><span data-stu-id="02516-140">Is this organization provisioned in [!INCLUDE[pn_MS_Online_Services](../../includes/pn-ms-online-services.md)] (y/n) [n]</span></span> |                                                                                                                    <span data-ttu-id="02516-141">Type **y** if this is a [!INCLUDE[pn_MS_Online_Services](../../includes/pn-ms-online-services.md)] provisioned organization.</span><span class="sxs-lookup"><span data-stu-id="02516-141">Type **y** if this is a [!INCLUDE[pn_MS_Online_Services](../../includes/pn-ms-online-services.md)] provisioned organization.</span></span> <span data-ttu-id="02516-142">Otherwise, type **n**.</span><span class="sxs-lookup"><span data-stu-id="02516-142">Otherwise, type **n**.</span></span>                                                                                                                    |
   |                                                  <span data-ttu-id="02516-143">Enter domain\username</span><span class="sxs-lookup"><span data-stu-id="02516-143">Enter domain\username</span></span>                                                   |                                                                                              <span data-ttu-id="02516-144">For [!INCLUDE[pn_CRM_Online](../../includes/pn-crm-online.md)], enter your [!INCLUDE[pn_Windows_Live_ID](../../includes/pn-windows-live-id.md)].</span><span class="sxs-lookup"><span data-stu-id="02516-144">For [!INCLUDE[pn_CRM_Online](../../includes/pn-crm-online.md)], enter your [!INCLUDE[pn_Windows_Live_ID](../../includes/pn-windows-live-id.md)].</span></span> <span data-ttu-id="02516-145">For example: someone@mydomain.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="02516-145">For example: someone@mydomain.onmicrosoft.com.</span></span>                                                                                              |
   |                                                      <span data-ttu-id="02516-146">Enter password</span><span class="sxs-lookup"><span data-stu-id="02516-146">Enter password</span></span>                                                      |                                                                                                          <span data-ttu-id="02516-147">Type your password.</span><span class="sxs-lookup"><span data-stu-id="02516-147">Type your password.</span></span> <span data-ttu-id="02516-148">Your password is securely saved in the [!INCLUDE[pn_Windows_Credential_Manager](../../includes/pn-windows-credential-manager.md)] for later reuse.</span><span class="sxs-lookup"><span data-stu-id="02516-148">Your password is securely saved in the [!INCLUDE[pn_Windows_Credential_Manager](../../includes/pn-windows-credential-manager.md)] for later reuse.</span></span>                                                                                                           |
   |                                         <span data-ttu-id="02516-149">Specify an organization number (1-n) [1]</span><span class="sxs-lookup"><span data-stu-id="02516-149">Specify an organization number (1-n) [1]</span></span>                                         |                                                                                                                 <span data-ttu-id="02516-150">From the list of organizations shown that you belong to, type the corresponding number.</span><span class="sxs-lookup"><span data-stu-id="02516-150">From the list of organizations shown that you belong to, type the corresponding number.</span></span> <span data-ttu-id="02516-151">The default is 1, indicating the first organization in the list.</span><span class="sxs-lookup"><span data-stu-id="02516-151">The default is 1, indicating the first organization in the list.</span></span>                                                                                                                  |


3. <span data-ttu-id="02516-152">The sample will perform the operations described in [What this sample does](sample-use-optimistic-concurrency-update-delete-operations.md#BKMK_WhatThisSampleDoes) and may prompt you with additional options.</span><span class="sxs-lookup"><span data-stu-id="02516-152">The sample will perform the operations described in [What this sample does](sample-use-optimistic-concurrency-update-delete-operations.md#BKMK_WhatThisSampleDoes) and may prompt you with additional options.</span></span>  

4. <span data-ttu-id="02516-153">When the sample is complete, press ENTER to close the console window.</span><span class="sxs-lookup"><span data-stu-id="02516-153">When the sample is complete, press ENTER to close the console window.</span></span>  

### <a name="see-also"></a><span data-ttu-id="02516-154">Xem thêm</span><span class="sxs-lookup"><span data-stu-id="02516-154">See also</span></span>  
 [<span data-ttu-id="02516-155">Reduce potential data loss using optimistic concurrency</span><span class="sxs-lookup"><span data-stu-id="02516-155">Reduce potential data loss using optimistic concurrency</span></span>](reduce-potential-data-loss-using-optimistic-concurrency.md)
