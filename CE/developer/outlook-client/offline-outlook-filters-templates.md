---
title: Offline and Outlook filters and templates (Developer Guide for Dynamics 365 for Customer Engagement)| MicrosoftDocs
description: Data that should be synchronized between the Dynamics 365 for Customer Engagement server and Dynamics 365 for Customer Engagement for Outlook is determined by Data Filters for Office Outlook
ms.custom: ''
ms.date: 10/31/2017
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
- Dynamics 365 for Customer Engagement (online)
ms.assetid: 3711daa2-27e8-494a-8e3b-52ba7c12022e
caps.latest.revision: 28
author: JimDaly
ms.author: jdaly
manager: amyla
search.audienceType:
- developer
search.app:
- D365CE
ms.openlocfilehash: bcef353ddaecf87107f360286ad3d3e44ed3fd05
ms.sourcegitcommit: 9f0efd59de16a6d9902fa372cb25fc0baf1c2838
ms.translationtype: HT
ms.contentlocale: vi-VN
ms.lasthandoff: 01/08/2019
ms.locfileid: "385692"
---
# <a name="offline-and-outlook-filters-and-templates"></a><span data-ttu-id="9027a-103">Offline and Outlook filters and templates</span><span class="sxs-lookup"><span data-stu-id="9027a-103">Offline and Outlook filters and templates</span></span>

[!INCLUDE[](../../includes/cc_applies_to_update_9_0_0.md)]

<span data-ttu-id="9027a-104">Data filters for [!INCLUDE[pn_MS_Outlook_Full](../../includes/pn-ms-outlook-full.md)] determine what data should be synchronized between the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps server and [!INCLUDE[pn_crm_for_outlook_short](../../includes/pn-crm-for-outlook-short.md)].</span><span class="sxs-lookup"><span data-stu-id="9027a-104">Data filters for [!INCLUDE[pn_MS_Outlook_Full](../../includes/pn-ms-outlook-full.md)] determine what data should be synchronized between the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps server and [!INCLUDE[pn_crm_for_outlook_short](../../includes/pn-crm-for-outlook-short.md)].</span></span> [!INCLUDE[pn_dynamics_crm_online](../../includes/pn-dynamics-crm-online.md)] <span data-ttu-id="9027a-105">apps supports the ability to change the default filter using the SDK and push these changes to any or all users.</span><span class="sxs-lookup"><span data-stu-id="9027a-105">apps supports the ability to change the default filter using the SDK and push these changes to any or all users.</span></span>  

 <span data-ttu-id="9027a-106">As part of the new support for filter customization, you can write code that allows administrators to create and publish filter templates.</span><span class="sxs-lookup"><span data-stu-id="9027a-106">As part of the new support for filter customization, you can write code that allows administrators to create and publish filter templates.</span></span> <span data-ttu-id="9027a-107">This allows a [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps administrator to create common or desirable filters that can be published to users for synchronizing with the [!INCLUDE[pn_MS_Outlook_Short](../../includes/pn-ms-outlook-short.md)] Store and offline database.</span><span class="sxs-lookup"><span data-stu-id="9027a-107">This allows a [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps administrator to create common or desirable filters that can be published to users for synchronizing with the [!INCLUDE[pn_MS_Outlook_Short](../../includes/pn-ms-outlook-short.md)] Store and offline database.</span></span> <span data-ttu-id="9027a-108">This also provides a way to customize the default filter template that will be applied for users who are added to the system after the templates are originally published.</span><span class="sxs-lookup"><span data-stu-id="9027a-108">This also provides a way to customize the default filter template that will be applied for users who are added to the system after the templates are originally published.</span></span> <span data-ttu-id="9027a-109">The administrator also has the ability to update or delete user filters after they are published.</span><span class="sxs-lookup"><span data-stu-id="9027a-109">The administrator also has the ability to update or delete user filters after they are published.</span></span>  

 <span data-ttu-id="9027a-110">To support these customizations, there are four new query types for saved query (view).</span><span class="sxs-lookup"><span data-stu-id="9027a-110">To support these customizations, there are four new query types for saved query (view).</span></span> <span data-ttu-id="9027a-111">When you create a saved query (view) record, specify one of these types in the `SavedQuery.QueryType` attribute, using the <xref:Microsoft.Crm.Sdk.SavedQueryQueryType> enumeration.</span><span class="sxs-lookup"><span data-stu-id="9027a-111">When you create a saved query (view) record, specify one of these types in the `SavedQuery.QueryType` attribute, using the <xref:Microsoft.Crm.Sdk.SavedQueryQueryType> enumeration.</span></span> <span data-ttu-id="9027a-112">These are only accessible by using the methods described here; there is no UI available to change them.</span><span class="sxs-lookup"><span data-stu-id="9027a-112">These are only accessible by using the methods described here; there is no UI available to change them.</span></span> <span data-ttu-id="9027a-113">You can specify different filters so that you can avoid synchronizing everything to [!INCLUDE[pn_MS_Outlook_Short](../../includes/pn-ms-outlook-short.md)] for your mobile phone.</span><span class="sxs-lookup"><span data-stu-id="9027a-113">You can specify different filters so that you can avoid synchronizing everything to [!INCLUDE[pn_MS_Outlook_Short](../../includes/pn-ms-outlook-short.md)] for your mobile phone.</span></span> <span data-ttu-id="9027a-114">Filter templates are solution aware so they can be exported along with a solution.</span><span class="sxs-lookup"><span data-stu-id="9027a-114">Filter templates are solution aware so they can be exported along with a solution.</span></span>  

 <span data-ttu-id="9027a-115">The following table lists the new query types used for filters and filter templates.</span><span class="sxs-lookup"><span data-stu-id="9027a-115">The following table lists the new query types used for filters and filter templates.</span></span>  


|                          <span data-ttu-id="9027a-116">Query type</span><span class="sxs-lookup"><span data-stu-id="9027a-116">Query type</span></span>                          |                                                                                                                                                           <span data-ttu-id="9027a-117">Mô tả</span><span class="sxs-lookup"><span data-stu-id="9027a-117">Description</span></span>                                                                                                                                                           |
|--------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OutlookFilters>  | <span data-ttu-id="9027a-118">Defines the subset of an entity to be synchronized with [!INCLUDE[pn_crm_for_outlook_short](../../includes/pn-crm-for-outlook-short.md)].</span><span class="sxs-lookup"><span data-stu-id="9027a-118">Defines the subset of an entity to be synchronized with [!INCLUDE[pn_crm_for_outlook_short](../../includes/pn-crm-for-outlook-short.md)].</span></span> <span data-ttu-id="9027a-119">The subset of data defined by these filters will synchronize to [!INCLUDE[pn_MS_Outlook_Short](../../includes/pn-ms-outlook-short.md)] folders such as Contacts, Calendar, and so on.</span><span class="sxs-lookup"><span data-stu-id="9027a-119">The subset of data defined by these filters will synchronize to [!INCLUDE[pn_MS_Outlook_Short](../../includes/pn-ms-outlook-short.md)] folders such as Contacts, Calendar, and so on.</span></span> |
| <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OfflineFilters>  |                                            <span data-ttu-id="9027a-120">Defines the subset of an entity to be synchronized with [!INCLUDE[pn_crm_outlook_offline_access](../../includes/pn-crm-outlook-offline-access.md)].</span><span class="sxs-lookup"><span data-stu-id="9027a-120">Defines the subset of an entity to be synchronized with [!INCLUDE[pn_crm_outlook_offline_access](../../includes/pn-crm-outlook-offline-access.md)].</span></span> <span data-ttu-id="9027a-121">The subset of data defined by these filters will synchronize to the offline database.</span><span class="sxs-lookup"><span data-stu-id="9027a-121">The subset of data defined by these filters will synchronize to the offline database.</span></span>                                            |
| <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OutlookTemplate> |                                                                                    <span data-ttu-id="9027a-122">Defines a filter template applied to new users for synchronization with [!INCLUDE[pn_crm_for_outlook_short](../../includes/pn-crm-for-outlook-short.md)].</span><span class="sxs-lookup"><span data-stu-id="9027a-122">Defines a filter template applied to new users for synchronization with [!INCLUDE[pn_crm_for_outlook_short](../../includes/pn-crm-for-outlook-short.md)].</span></span>                                                                                    |
| <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OfflineTemplate> |                                                                               <span data-ttu-id="9027a-123">Defines a filter template applied to new users for synchronization with [!INCLUDE[pn_crm_outlook_offline_access](../../includes/pn-crm-outlook-offline-access.md)].</span><span class="sxs-lookup"><span data-stu-id="9027a-123">Defines a filter template applied to new users for synchronization with [!INCLUDE[pn_crm_outlook_offline_access](../../includes/pn-crm-outlook-offline-access.md)].</span></span>                                                                               |

## <a name="instantiate-a-filter"></a><span data-ttu-id="9027a-124">Instantiate a filter</span><span class="sxs-lookup"><span data-stu-id="9027a-124">Instantiate a filter</span></span>  
 <span data-ttu-id="9027a-125">Default filter templates are automatically instantiated to the `UserQuery` entity for each user when the synchronization subscription is created.</span><span class="sxs-lookup"><span data-stu-id="9027a-125">Default filter templates are automatically instantiated to the `UserQuery` entity for each user when the synchronization subscription is created.</span></span> <span data-ttu-id="9027a-126">When synchronization to [!INCLUDE[pn_MS_Outlook_Short](../../includes/pn-ms-outlook-short.md)] or to the offline database is initiated, the filters for that user are collected and used to filter the collections of entries and attributes that are being synchronized.</span><span class="sxs-lookup"><span data-stu-id="9027a-126">When synchronization to [!INCLUDE[pn_MS_Outlook_Short](../../includes/pn-ms-outlook-short.md)] or to the offline database is initiated, the filters for that user are collected and used to filter the collections of entries and attributes that are being synchronized.</span></span> <span data-ttu-id="9027a-127">If multiple filters are specified for a particular entity, the resulting set of entries will be a union of results of individual filters.</span><span class="sxs-lookup"><span data-stu-id="9027a-127">If multiple filters are specified for a particular entity, the resulting set of entries will be a union of results of individual filters.</span></span>  

 <span data-ttu-id="9027a-128">There is a new privilege allowing the administrator to access other user's filters: `prvAdminFilter`.</span><span class="sxs-lookup"><span data-stu-id="9027a-128">There is a new privilege allowing the administrator to access other user's filters: `prvAdminFilter`.</span></span> <span data-ttu-id="9027a-129">This is called Manage User Synchronization Filters in the Web application.</span><span class="sxs-lookup"><span data-stu-id="9027a-129">This is called Manage User Synchronization Filters in the Web application.</span></span> <span data-ttu-id="9027a-130">The system administrator role includes this privilege because without it, only the user can see his or her filters.</span><span class="sxs-lookup"><span data-stu-id="9027a-130">The system administrator role includes this privilege because without it, only the user can see his or her filters.</span></span> <span data-ttu-id="9027a-131">Calling the <xref:Microsoft.Xrm.Sdk.IOrganizationService>.<xref:Microsoft.Xrm.Sdk.IOrganizationService.RetrieveMultiple*></span><span class="sxs-lookup"><span data-stu-id="9027a-131">Calling the <xref:Microsoft.Xrm.Sdk.IOrganizationService>.<xref:Microsoft.Xrm.Sdk.IOrganizationService.RetrieveMultiple*></span></span> <span data-ttu-id="9027a-132">method on the user query will retrieve records only for the owning user, unless the caller has the `prvAdminFilter` privilege The query must contain conditions where `QueryType` equals <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OutlookFilters> or <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OfflineFilters> AND `OwnerId` equals `UserId`, where the `UserId` is not equal to caller.</span><span class="sxs-lookup"><span data-stu-id="9027a-132">method on the user query will retrieve records only for the owning user, unless the caller has the `prvAdminFilter` privilege The query must contain conditions where `QueryType` equals <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OutlookFilters> or <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OfflineFilters> AND `OwnerId` equals `UserId`, where the `UserId` is not equal to caller.</span></span> <span data-ttu-id="9027a-133">If any other conditions are added to the query, this will not work.</span><span class="sxs-lookup"><span data-stu-id="9027a-133">If any other conditions are added to the query, this will not work.</span></span>  

 <span data-ttu-id="9027a-134">New users automatically are given the filters from the filter templates that are marked as default in the `SavedQuery.IsDefault` attribute.</span><span class="sxs-lookup"><span data-stu-id="9027a-134">New users automatically are given the filters from the filter templates that are marked as default in the `SavedQuery.IsDefault` attribute.</span></span> <span data-ttu-id="9027a-135">Administrators need to know that they can change this value to affect this.</span><span class="sxs-lookup"><span data-stu-id="9027a-135">Administrators need to know that they can change this value to affect this.</span></span> <span data-ttu-id="9027a-136">Each entity can have only one filter template that is marked as default.</span><span class="sxs-lookup"><span data-stu-id="9027a-136">Each entity can have only one filter template that is marked as default.</span></span> <span data-ttu-id="9027a-137">There can be no default filters, only filter templates.</span><span class="sxs-lookup"><span data-stu-id="9027a-137">There can be no default filters, only filter templates.</span></span> <span data-ttu-id="9027a-138">If you create a custom entity, and set the <xref:Microsoft.Xrm.Sdk.Metadata.EntityMetadata.IsAvailableOffline> property, a default filter template is created automatically.</span><span class="sxs-lookup"><span data-stu-id="9027a-138">If you create a custom entity, and set the <xref:Microsoft.Xrm.Sdk.Metadata.EntityMetadata.IsAvailableOffline> property, a default filter template is created automatically.</span></span>  

 <span data-ttu-id="9027a-139">There is a new type of filter that administrators can define, called system filters.</span><span class="sxs-lookup"><span data-stu-id="9027a-139">There is a new type of filter that administrators can define, called system filters.</span></span> <span data-ttu-id="9027a-140">These filters are defined as `SavedQuery` records with the query type of <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OutlookFilters> or <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OfflineFilters>.</span><span class="sxs-lookup"><span data-stu-id="9027a-140">These filters are defined as `SavedQuery` records with the query type of <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OutlookFilters> or <xref:Microsoft.Crm.Sdk.SavedQueryQueryType.OfflineFilters>.</span></span> <span data-ttu-id="9027a-141">System filters automatically apply to all users, and cannot be modified by the users.</span><span class="sxs-lookup"><span data-stu-id="9027a-141">System filters automatically apply to all users, and cannot be modified by the users.</span></span>  

 <span data-ttu-id="9027a-142">There is a limit on the number of filters you can add.</span><span class="sxs-lookup"><span data-stu-id="9027a-142">There is a limit on the number of filters you can add.</span></span> <span data-ttu-id="9027a-143">This setting is controlled by the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps deployment administrator to prevent users or administrators from creating too many filters, which affects server performance.</span><span class="sxs-lookup"><span data-stu-id="9027a-143">This setting is controlled by the [!INCLUDE[pn_dynamics_crm](../../includes/pn-dynamics-crm.md)] apps deployment administrator to prevent users or administrators from creating too many filters, which affects server performance.</span></span> <span data-ttu-id="9027a-144">The same limit setting is applied to all entities.</span><span class="sxs-lookup"><span data-stu-id="9027a-144">The same limit setting is applied to all entities.</span></span>  

 <span data-ttu-id="9027a-145">By default, there are unlimited settings for both system filters and user filters.</span><span class="sxs-lookup"><span data-stu-id="9027a-145">By default, there are unlimited settings for both system filters and user filters.</span></span>  

## <a name="instantiate-a-template"></a><span data-ttu-id="9027a-146">Instantiate a template</span><span class="sxs-lookup"><span data-stu-id="9027a-146">Instantiate a template</span></span>  
 <span data-ttu-id="9027a-147">You can instantiate one or more filters per user.</span><span class="sxs-lookup"><span data-stu-id="9027a-147">You can instantiate one or more filters per user.</span></span> <span data-ttu-id="9027a-148">To do this manually, use the <xref:Microsoft.Crm.Sdk.Messages.InstantiateFiltersRequest> to instantiate a filter, creating a user query record.</span><span class="sxs-lookup"><span data-stu-id="9027a-148">To do this manually, use the <xref:Microsoft.Crm.Sdk.Messages.InstantiateFiltersRequest> to instantiate a filter, creating a user query record.</span></span> <span data-ttu-id="9027a-149">Each user query record contains a reference back to the filter.</span><span class="sxs-lookup"><span data-stu-id="9027a-149">Each user query record contains a reference back to the filter.</span></span> <span data-ttu-id="9027a-150">If you update the filter, you can call instantiate again to refresh or override the user’s changes to the filter (user query record).</span><span class="sxs-lookup"><span data-stu-id="9027a-150">If you update the filter, you can call instantiate again to refresh or override the user’s changes to the filter (user query record).</span></span>  

## <a name="reset-a-users-filters-to-the-default"></a><span data-ttu-id="9027a-151">Reset a user’s filters to the default</span><span class="sxs-lookup"><span data-stu-id="9027a-151">Reset a user’s filters to the default</span></span>  
 <span data-ttu-id="9027a-152">You can reset the filters for a user to the default by using the <xref:Microsoft.Crm.Sdk.Messages.ResetUserFiltersRequest>.</span><span class="sxs-lookup"><span data-stu-id="9027a-152">You can reset the filters for a user to the default by using the <xref:Microsoft.Crm.Sdk.Messages.ResetUserFiltersRequest>.</span></span>  

### <a name="see-also"></a><span data-ttu-id="9027a-153">Xem thêm</span><span class="sxs-lookup"><span data-stu-id="9027a-153">See also</span></span>  
 <span data-ttu-id="9027a-154">[Extend Dynamics 365 for Customer Engagement for Outlook](../extend-customer-engagement-outlook.md) </span><span class="sxs-lookup"><span data-stu-id="9027a-154">[Extend Dynamics 365 for Customer Engagement for Outlook](../extend-customer-engagement-outlook.md) </span></span>  
 <span data-ttu-id="9027a-155">[SavedQuery Entity Reference](../entities/savedquery.md) </span><span class="sxs-lookup"><span data-stu-id="9027a-155">[SavedQuery Entity Reference](../entities/savedquery.md) </span></span>  
 <span data-ttu-id="9027a-156">[Sample: Retrieve Outlook Filters](sample-create-retrieve-outlook-filters.md)  </span><span class="sxs-lookup"><span data-stu-id="9027a-156">[Sample: Retrieve Outlook Filters](sample-create-retrieve-outlook-filters.md)  </span></span>  
 <xref:Microsoft.Crm.Sdk.Messages.InstantiateFiltersRequest>   
 <xref:Microsoft.Crm.Sdk.Messages.ResetUserFiltersRequest>
