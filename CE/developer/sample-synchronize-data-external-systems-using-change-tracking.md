---
title: 'Sample: Synchronize data with external systems using change tracking (Developer Guide for Dynamics 365 for Customer Engagement apps)| MicrosoftDocs'
description: This sample code shows how to retrieve changes from an entity and synchronize data with external systems by using the RetrieveEntityChangesRequest message
ms.custom: ''
ms.date: 10/31/2017
ms.reviewer: ''
ms.service: crm-online
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: samples
applies_to:
- Dynamics 365 for Customer Engagement (online)
ms.assetid: 14464805-0405-4e19-9d95-6c031de8ae3f
caps.latest.revision: 21
author: JimDaly
ms.author: jdaly
manager: amyla
search.audienceType:
- developer
search.app:
- D365CE
ms.openlocfilehash: 477221497c6ee7cf7d71e76670fcdc08b9661a90
ms.sourcegitcommit: 9f0efd59de16a6d9902fa372cb25fc0baf1c2838
ms.translationtype: HT
ms.contentlocale: vi-VN
ms.lasthandoff: 01/08/2019
ms.locfileid: "387965"
---
# <a name="sample-synchronize-data-with-external-systems-using-change-tracking"></a><span data-ttu-id="cd4bf-103">Sample: Synchronize data with external systems using change tracking</span><span class="sxs-lookup"><span data-stu-id="cd4bf-103">Sample: Synchronize data with external systems using change tracking</span></span>

[!INCLUDE[](../includes/cc_applies_to_update_9_0_0.md)]

<span data-ttu-id="cd4bf-104">This sample code shows how to retrieve changes from an entity and synchronize data with external systems by using the `RetrieveEntityChangesRequest` message.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-104">This sample code shows how to retrieve changes from an entity and synchronize data with external systems by using the `RetrieveEntityChangesRequest` message.</span></span> <span data-ttu-id="cd4bf-105">For more information about the feature that this sample demonstrates, see [Use change tracking to synchronize data with external systems](use-change-tracking-synchronize-data-external-systems.md).</span><span class="sxs-lookup"><span data-stu-id="cd4bf-105">For more information about the feature that this sample demonstrates, see [Use change tracking to synchronize data with external systems](use-change-tracking-synchronize-data-external-systems.md).</span></span>  

 <span data-ttu-id="cd4bf-106">This sample requires [!INCLUDE[pn_crm_8_1_0_both](../includes/pn-crm-8-1-0-both.md)] or later .</span><span class="sxs-lookup"><span data-stu-id="cd4bf-106">This sample requires [!INCLUDE[pn_crm_8_1_0_both](../includes/pn-crm-8-1-0-both.md)] or later .</span></span> <span data-ttu-id="cd4bf-107">This sample is available to download from [Synchronize data with external systems using change tracking](http://go.microsoft.com/fwlink/p/?LinkId=533957).</span><span class="sxs-lookup"><span data-stu-id="cd4bf-107">This sample is available to download from [Synchronize data with external systems using change tracking](http://go.microsoft.com/fwlink/p/?LinkId=533957).</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="cd4bf-108">Điều kiện tiên quyết</span><span class="sxs-lookup"><span data-stu-id="cd4bf-108">Prerequisites</span></span>  

1. <span data-ttu-id="cd4bf-109">Have access to a [!INCLUDE[pn_crm_8_1_0_both](../includes/pn-crm-8-1-0-both.md)] or later organization.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-109">Have access to a [!INCLUDE[pn_crm_8_1_0_both](../includes/pn-crm-8-1-0-both.md)] or later organization.</span></span>  

2. <span data-ttu-id="cd4bf-110">Download the ChangeTrackingSample Visual Studio project.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-110">Download the ChangeTrackingSample Visual Studio project.</span></span>  

3. <span data-ttu-id="cd4bf-111">Open the ChangeTrackingSample Visual Studio project and install the latest Microsoft.CrmSdk.CoreAssemblies NuGet Package.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-111">Open the ChangeTrackingSample Visual Studio project and install the latest Microsoft.CrmSdk.CoreAssemblies NuGet Package.</span></span> <span data-ttu-id="cd4bf-112">See [Install NuGet packages](#BKMK_install) for instructions.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-112">See [Install NuGet packages](#BKMK_install) for instructions.</span></span>  

4. <span data-ttu-id="cd4bf-113">After you install the NuGet packages, see [Run the sample](#BKMK_runSample) for instructions on how to run the sample and what to expect.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-113">After you install the NuGet packages, see [Run the sample](#BKMK_runSample) for instructions on how to run the sample and what to expect.</span></span>  

<a name="BKMK_whatsampledoes"></a>   
## <a name="what-this-sample-does"></a><span data-ttu-id="cd4bf-114">What this sample does</span><span class="sxs-lookup"><span data-stu-id="cd4bf-114">What this sample does</span></span>  

1. <span data-ttu-id="cd4bf-115">The `ChangeTrackingSample` class `Run` method calls the `ImportChangeTrackingSolution` method which first detects whether the ChangeTrackingSample managed solution is already installed.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-115">The `ChangeTrackingSample` class `Run` method calls the `ImportChangeTrackingSolution` method which first detects whether the ChangeTrackingSample managed solution is already installed.</span></span> <span data-ttu-id="cd4bf-116">If it is not, the ChangeTrackingSample_1_0_0_0_managed.zip file is imported to install this managed solution.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-116">If it is not, the ChangeTrackingSample_1_0_0_0_managed.zip file is imported to install this managed solution.</span></span>  

    <span data-ttu-id="cd4bf-117">This managed solution contains a custom sample_book entity that is used by this sample.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-117">This managed solution contains a custom sample_book entity that is used by this sample.</span></span> <span data-ttu-id="cd4bf-118">This entity has a sample_bookcode alternate key that creates a unique constraint on the values stored in that attribute.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-118">This entity has a sample_bookcode alternate key that creates a unique constraint on the values stored in that attribute.</span></span>  

2. <span data-ttu-id="cd4bf-119">The `WaitForEntityAndKeysToBeActive` method is necessary because the alternate keys required for this sample may not be ready immediately after the ChangeTrackingSample solution is installed.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-119">The `WaitForEntityAndKeysToBeActive` method is necessary because the alternate keys required for this sample may not be ready immediately after the ChangeTrackingSample solution is installed.</span></span> <span data-ttu-id="cd4bf-120">This method polls the metadata for the sample_book entity to delay the execution of the rest of the sample until the alternate keys are ready.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-120">This method polls the metadata for the sample_book entity to delay the execution of the rest of the sample until the alternate keys are ready.</span></span>  

3. <span data-ttu-id="cd4bf-121">`CreateRequiredRecords` method generates 10 records in the sample_book entity.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-121">`CreateRequiredRecords` method generates 10 records in the sample_book entity.</span></span>  

4. <span data-ttu-id="cd4bf-122">The first time the `RetrieveEntityChangesRequest` is called; it performs an initial synchronization and retrieves all the records in the entity along with the version number and caches the retrieved records.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-122">The first time the `RetrieveEntityChangesRequest` is called; it performs an initial synchronization and retrieves all the records in the entity along with the version number and caches the retrieved records.</span></span>  

5. <span data-ttu-id="cd4bf-123">After caching the initial records, the program asks if you want to view the sample_book entity records.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-123">After caching the initial records, the program asks if you want to view the sample_book entity records.</span></span> <span data-ttu-id="cd4bf-124">If you respond with ‘y’ the program will attempt to open [!INCLUDE[pn_Internet_Explorer](../includes/pn-internet-explorer.md)] to a view showing the newly created records.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-124">If you respond with ‘y’ the program will attempt to open [!INCLUDE[pn_Internet_Explorer](../includes/pn-internet-explorer.md)] to a view showing the newly created records.</span></span>  

6. <span data-ttu-id="cd4bf-125">`UpdateRecords` method adds ten new records, updates an existing record and deletes a record in the sample_book entity.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-125">`UpdateRecords` method adds ten new records, updates an existing record and deletes a record in the sample_book entity.</span></span>  

7. <span data-ttu-id="cd4bf-126">After updating the records, the program resets the paging information and instantiates the cache objects.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-126">After updating the records, the program resets the paging information and instantiates the cache objects.</span></span>  

8. <span data-ttu-id="cd4bf-127">When `RetrieveEntityChangesRequest` is called again, it only retrieves the updated records since the last synchronization.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-127">When `RetrieveEntityChangesRequest` is called again, it only retrieves the updated records since the last synchronization.</span></span>  

9. <span data-ttu-id="cd4bf-128">After retrieving the changes, the program will ask if you want to view the sample_book entity records.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-128">After retrieving the changes, the program will ask if you want to view the sample_book entity records.</span></span> <span data-ttu-id="cd4bf-129">If you respond with ‘y’ the program will attempt to open [!INCLUDE[pn_Internet_Explorer](../includes/pn-internet-explorer.md)] to a view showing the newly created records.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-129">If you respond with ‘y’ the program will attempt to open [!INCLUDE[pn_Internet_Explorer](../includes/pn-internet-explorer.md)] to a view showing the newly created records.</span></span>  

10. <span data-ttu-id="cd4bf-130">Finally, the `DeleteChangeTrackingSampleSolution` will prompt you to delete the ChangeTrackingSample managed solution.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-130">Finally, the `DeleteChangeTrackingSampleSolution` will prompt you to delete the ChangeTrackingSample managed solution.</span></span>  

     <span data-ttu-id="cd4bf-131">If you select “y”, the managed solution will be deleted including the sample_book entity and all the data in that entity.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-131">If you select “y”, the managed solution will be deleted including the sample_book entity and all the data in that entity.</span></span> <span data-ttu-id="cd4bf-132">Your organization will be left with nothing added to it.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-132">Your organization will be left with nothing added to it.</span></span>  

     <span data-ttu-id="cd4bf-133">If you select “n”, you can inspect the details of the solution including the data created by the sample.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-133">If you select “n”, you can inspect the details of the solution including the data created by the sample.</span></span> <span data-ttu-id="cd4bf-134">But you must manually delete the managed solution to return your organization to the original state.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-134">But you must manually delete the managed solution to return your organization to the original state.</span></span>  

<a name="BKMK_install"></a>   
## <a name="install-nuget-packages"></a><span data-ttu-id="cd4bf-135">Install NuGet packages</span><span class="sxs-lookup"><span data-stu-id="cd4bf-135">Install NuGet packages</span></span>  
 <span data-ttu-id="cd4bf-136">Use the following steps to install the required assemblies for this sample:</span><span class="sxs-lookup"><span data-stu-id="cd4bf-136">Use the following steps to install the required assemblies for this sample:</span></span>  

1.  <span data-ttu-id="cd4bf-137">Download this sample and extract the files.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-137">Download this sample and extract the files.</span></span>  

2.  <span data-ttu-id="cd4bf-138">Navigate to the C# folder and open the ChangeTrackingSample.sln file using Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-138">Navigate to the C# folder and open the ChangeTrackingSample.sln file using Visual Studio.</span></span>  

3.  <span data-ttu-id="cd4bf-139">In Visual Studio, right-click the ChangeTrackingSample project and chose **Manage NuGet Packages**.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-139">In Visual Studio, right-click the ChangeTrackingSample project and chose **Manage NuGet Packages**.</span></span>  

4.  <span data-ttu-id="cd4bf-140">For the preview release, make sure to select **Include Prerelease** rather than **Stable Only** in the search criteria.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-140">For the preview release, make sure to select **Include Prerelease** rather than **Stable Only** in the search criteria.</span></span> <span data-ttu-id="cd4bf-141">Then search for “Microsoft Dynamics CRM 2016 SDK core assemblies”.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-141">Then search for “Microsoft Dynamics CRM 2016 SDK core assemblies”.</span></span> <span data-ttu-id="cd4bf-142">Make sure you select the latest version.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-142">Make sure you select the latest version.</span></span>  

5.  <span data-ttu-id="cd4bf-143">Bấm vào **cài đặt**.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-143">Click **Install**.</span></span> <span data-ttu-id="cd4bf-144">You’ll need to accept the license terms to complete installing this package.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-144">You’ll need to accept the license terms to complete installing this package.</span></span>  

<a name="BKMK_runSample"></a>   
## <a name="run-the-sample"></a><span data-ttu-id="cd4bf-145">Run the sample</span><span class="sxs-lookup"><span data-stu-id="cd4bf-145">Run the sample</span></span>  

1. <span data-ttu-id="cd4bf-146">In Visual Studio, with the solution open and the necessary NuGet packages installed, press F5.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-146">In Visual Studio, with the solution open and the necessary NuGet packages installed, press F5.</span></span>  

2. <span data-ttu-id="cd4bf-147">If you have not previously run one of the Dynamics 365 for Customer Engagement managed code samples before, you’ll need to enter information to run the code, otherwise enter the number for one of the Dynamics 365 for Customer Engagement servers you have previously set up.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-147">If you have not previously run one of the Dynamics 365 for Customer Engagement managed code samples before, you’ll need to enter information to run the code, otherwise enter the number for one of the Dynamics 365 for Customer Engagement servers you have previously set up.</span></span>  


   |                                 <span data-ttu-id="cd4bf-148">Prompt</span><span class="sxs-lookup"><span data-stu-id="cd4bf-148">Prompt</span></span>                                  |                                                                                                                                                                                      <span data-ttu-id="cd4bf-149">Mô tả</span><span class="sxs-lookup"><span data-stu-id="cd4bf-149">Description</span></span>                                                                                                                                                                                       |
   |-------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |      <span data-ttu-id="cd4bf-150">Enter a Dynamics 365 for Customer Engagement server name and port [crm.dynamics.com]</span><span class="sxs-lookup"><span data-stu-id="cd4bf-150">Enter a Dynamics 365 for Customer Engagement server name and port [crm.dynamics.com]</span></span>       | <span data-ttu-id="cd4bf-151">Type the name of your Dynamics 365 for Customer Engagement server.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-151">Type the name of your Dynamics 365 for Customer Engagement server.</span></span> <span data-ttu-id="cd4bf-152">The default is [!INCLUDE[pn_CRM_Online](../includes/pn-crm-online.md)] (crm.dynamics.com) in North America.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-152">The default is [!INCLUDE[pn_CRM_Online](../includes/pn-crm-online.md)] (crm.dynamics.com) in North America.</span></span><br /><br /> <span data-ttu-id="cd4bf-153">Ví dụ: </span><span class="sxs-lookup"><span data-stu-id="cd4bf-153">Example:</span></span> <br /><span data-ttu-id="cd4bf-154">myservername</span><span class="sxs-lookup"><span data-stu-id="cd4bf-154">myservername</span></span><br /><span data-ttu-id="cd4bf-155">myprefix.myservername:5500</span><span class="sxs-lookup"><span data-stu-id="cd4bf-155">myprefix.myservername:5500</span></span><br /><span data-ttu-id="cd4bf-156">crm5.dynamics.com</span><span class="sxs-lookup"><span data-stu-id="cd4bf-156">crm5.dynamics.com</span></span><br /><br /> <span data-ttu-id="cd4bf-157">Don’t include the name of your organization or Internet protocol (http or https).</span><span class="sxs-lookup"><span data-stu-id="cd4bf-157">Don’t include the name of your organization or Internet protocol (http or https).</span></span> <span data-ttu-id="cd4bf-158">You’ll be prompted for that later.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-158">You’ll be prompted for that later.</span></span> |
   |  <span data-ttu-id="cd4bf-159">Is this server configured for Secure Sockets Layer (https) (y/n) [n]</span><span class="sxs-lookup"><span data-stu-id="cd4bf-159">Is this server configured for Secure Sockets Layer (https) (y/n) [n]</span></span>   |                                                                                                                                            <span data-ttu-id="cd4bf-160">Type **y** if the URL you use to access Dynamics 365 for Customer Engagement begins with https://, otherwise type **n**.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-160">Type **y** if the URL you use to access Dynamics 365 for Customer Engagement begins with https://, otherwise type **n**.</span></span>                                                                                                                                            |
   | <span data-ttu-id="cd4bf-161">Is this organization provisioned in Microsoft online services (y/n) [n]</span><span class="sxs-lookup"><span data-stu-id="cd4bf-161">Is this organization provisioned in Microsoft online services (y/n) [n]</span></span> |                                                                                                                                           <span data-ttu-id="cd4bf-162">Type **y** if this is a Microsoft online services provisioned organization.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-162">Type **y** if this is a Microsoft online services provisioned organization.</span></span> <span data-ttu-id="cd4bf-163">Otherwise, type **n**.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-163">Otherwise, type **n**.</span></span>                                                                                                                                           |
   |                          <span data-ttu-id="cd4bf-164">Enter domain\username</span><span class="sxs-lookup"><span data-stu-id="cd4bf-164">Enter domain\username</span></span>                          |                                                                                                       <span data-ttu-id="cd4bf-165">Type your Microsoft account.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-165">Type your Microsoft account.</span></span> <br /><span data-ttu-id="cd4bf-166">For [!INCLUDE[pn_crm_op_edition](../includes/pn-crm-onprem.md)], type your network domain and user name separated by a backslash (\\).</span><span class="sxs-lookup"><span data-stu-id="cd4bf-166">For [!INCLUDE[pn_crm_op_edition](../includes/pn-crm-onprem.md)], type your network domain and user name separated by a backslash (\\).</span></span>                                                                                                        |
   |                             <span data-ttu-id="cd4bf-167">Enter password</span><span class="sxs-lookup"><span data-stu-id="cd4bf-167">Enter password</span></span>                              |                                                                                                                <span data-ttu-id="cd4bf-168">Type your password.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-168">Type your password.</span></span> <span data-ttu-id="cd4bf-169">The characters will show as “\*” in the window.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-169">The characters will show as “\*” in the window.</span></span> <span data-ttu-id="cd4bf-170">Your password is securely saved in the Microsoft Credential Manager for later reuse.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-170">Your password is securely saved in the Microsoft Credential Manager for later reuse.</span></span>                                                                                                                |
   |                <span data-ttu-id="cd4bf-171">Specify an organization number (1-n) [1]</span><span class="sxs-lookup"><span data-stu-id="cd4bf-171">Specify an organization number (1-n) [1]</span></span>                 |                                                                                                                <span data-ttu-id="cd4bf-172">From the list of organizations shown that you belong to, type the corresponding number.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-172">From the list of organizations shown that you belong to, type the corresponding number.</span></span> <span data-ttu-id="cd4bf-173">The default is 1, indicating the first organization in the list.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-173">The default is 1, indicating the first organization in the list.</span></span>                                                                                                                |


3. <span data-ttu-id="cd4bf-174">The sample will perform the operations described in [What this sample does](#BKMK_whatsampledoes) and may prompt you with additional options.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-174">The sample will perform the operations described in [What this sample does](#BKMK_whatsampledoes) and may prompt you with additional options.</span></span>  

4. <span data-ttu-id="cd4bf-175">When the sample is complete, press ENTER to close the console window.</span><span class="sxs-lookup"><span data-stu-id="cd4bf-175">When the sample is complete, press ENTER to close the console window.</span></span>  

### <a name="see-also"></a><span data-ttu-id="cd4bf-176">Xem thêm</span><span class="sxs-lookup"><span data-stu-id="cd4bf-176">See also</span></span>  
 [<span data-ttu-id="cd4bf-177">Use change tracking to synchronize data with external systems</span><span class="sxs-lookup"><span data-stu-id="cd4bf-177">Use change tracking to synchronize data with external systems</span></span>](use-change-tracking-synchronize-data-external-systems.md)
