---
title: Considerations for creating a CTI adapter for Unified Service Desk | MicrosoftDocs
description: 'The topic provides information on things to consider while creating a computer telephony integration (CTI) adapter to make it work with Unified Service Desk. '
ms.custom:
- dyn365-USD
ms.date: 08/23/2017
ms.reviewer: ''
ms.service: dynamics-365-customerservice
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
applies_to:
- Dynamics 365 for Customer Engagement apps
- Dynamics 365 for Customer Engagement (on-premises) apps
- Dynamics CRM 2013
- Dynamics CRM 2015
- Dynamics CRM 2016
ms.assetid: 6b59cb93-8e3b-4224-b6fe-c9964fcefbfb
caps.latest.revision: 8
author: kabala123
ms.author: kabala
manager: shujoshi
search.audienceType:
- customizer
- developer
search.app:
- D365CE
- D365USD
ms.openlocfilehash: 4c4c6fb76c972e8c42497a966dbd8770f18e67a9
ms.sourcegitcommit: 9f0efd59de16a6d9902fa372cb25fc0baf1c2838
ms.translationtype: HT
ms.contentlocale: vi-VN
ms.lasthandoff: 01/08/2019
ms.locfileid: "385830"
---
# <a name="considerations-for-creating-a-cti-adapter-for-unified-service-desk"></a><span data-ttu-id="4e2a1-103">Considerations for creating a CTI adapter for Unified Service Desk</span><span class="sxs-lookup"><span data-stu-id="4e2a1-103">Considerations for creating a CTI adapter for Unified Service Desk</span></span>
<span data-ttu-id="4e2a1-104">This topic provides information on things to consider while creating a computer telephony integration (CTI) adapter to make it work with [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span><span class="sxs-lookup"><span data-stu-id="4e2a1-104">This topic provides information on things to consider while creating a computer telephony integration (CTI) adapter to make it work with [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span></span>  

<a name="UISpec"></a>   
## <a name="cti-control-softphone-user-interface-specification"></a><span data-ttu-id="4e2a1-105">CTI Control (softphone user interface) specification</span><span class="sxs-lookup"><span data-stu-id="4e2a1-105">CTI Control (softphone user interface) specification</span></span>  
 <span data-ttu-id="4e2a1-106">To ensure that softphone and [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] user interface components will interoperate with [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)], make sure of the following:</span><span class="sxs-lookup"><span data-stu-id="4e2a1-106">To ensure that softphone and [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] user interface components will interoperate with [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)], make sure of the following:</span></span>  

- <span data-ttu-id="4e2a1-107">Controls are created using [!INCLUDE[pn_ms_Windows_Presentation_Foundation](../includes/pn-ms-windows-presentation-foundation.md)], and are derived from the [DynamicsBaseHostedControl](https://docs.microsoft.com/dotnet/api/microsoft.crm.unifiedservicedesk.dynamics.dynamicsbasehostedcontrol) class.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-107">Controls are created using [!INCLUDE[pn_ms_Windows_Presentation_Foundation](../includes/pn-ms-windows-presentation-foundation.md)], and are derived from the [DynamicsBaseHostedControl](https://docs.microsoft.com/dotnet/api/microsoft.crm.unifiedservicedesk.dynamics.dynamicsbasehostedcontrol) class.</span></span>  

- [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] <span data-ttu-id="4e2a1-108">controls are placed on `CtiPanel`  panel in [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span><span class="sxs-lookup"><span data-stu-id="4e2a1-108">controls are placed on `CtiPanel`  panel in [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span></span> <span data-ttu-id="4e2a1-109">The height of the control should be 23 to fit in `CtiPanel`.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-109">The height of the control should be 23 to fit in `CtiPanel`.</span></span> <span data-ttu-id="4e2a1-110">Larger controls may be used.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-110">Larger controls may be used.</span></span>  

- <span data-ttu-id="4e2a1-111">Multiple [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] control or user interface components can exist on `CtiPanel`.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-111">Multiple [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] control or user interface components can exist on `CtiPanel`.</span></span> <span data-ttu-id="4e2a1-112">This is a horizontal stack panel so if you have multiple controls on this panel, they will appear next to each other.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-112">This is a horizontal stack panel so if you have multiple controls on this panel, they will appear next to each other.</span></span>  

<a name="Actions"></a>   
## <a name="actions-supported-for-telephony-functions"></a><span data-ttu-id="4e2a1-113">Hành động được hỗ trợ cho các chức năng điện thoại</span><span class="sxs-lookup"><span data-stu-id="4e2a1-113">Actions supported for telephony functions</span></span>  
 <span data-ttu-id="4e2a1-114">Tính năng của [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] là khả năng cấu hình thiết kế ứng dụng nâng cao mà không cần lập trình.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-114">A feature of [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] is the ability to configure advanced application designs without programming.</span></span> <span data-ttu-id="4e2a1-115">Loại chức năng tiếp xúc thông qua các khái niệm về các hành động trong [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span><span class="sxs-lookup"><span data-stu-id="4e2a1-115">This kind of functionality is exposed through the concept of actions in [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span></span> <span data-ttu-id="4e2a1-116">To support the idea of extending telephony control functions to buttons, agent scripts, and links in hosted applications, the system relies on actions being defined for capabilities exposed by the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] adapter.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-116">To support the idea of extending telephony control functions to buttons, agent scripts, and links in hosted applications, the system relies on actions being defined for capabilities exposed by the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] adapter.</span></span> <span data-ttu-id="4e2a1-117">This is done by exposing UII Actions in the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control of your [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] component.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-117">This is done by exposing UII Actions in the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control of your [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] component.</span></span> <span data-ttu-id="4e2a1-118">Mỗi hành động trong số những hành động này cung cấp cho các quản trị viên quyền kiểm soát nhiều hơn hành vi của ứng dụng.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-118">Each of these actions gives the administrator more control over the behavior of the application.</span></span>  

 <span data-ttu-id="4e2a1-119">It is recommended that the following actions be defined and implemented in the **CTI Desktop Manager** hosted control.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-119">It is recommended that the following actions be defined and implemented in the **CTI Desktop Manager** hosted control.</span></span>  

|<span data-ttu-id="4e2a1-120">Hành động</span><span class="sxs-lookup"><span data-stu-id="4e2a1-120">Action</span></span>|<span data-ttu-id="4e2a1-121">Mô tả</span><span class="sxs-lookup"><span data-stu-id="4e2a1-121">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="4e2a1-122">Quay số</span><span class="sxs-lookup"><span data-stu-id="4e2a1-122">Dial</span></span>|<span data-ttu-id="4e2a1-123">Số để gọi.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-123">The number to call.</span></span> <span data-ttu-id="4e2a1-124">Nếu tham số này không được cung cấp, một bảng quay số sẽ được hiển thị cho người dùng để nhập chữ số.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-124">If this parameter is not provided, a dialpad will be displayed for the user to enter digits.</span></span><br /><br /> <span data-ttu-id="4e2a1-125">Nếu cuộc gọi là cuộc gọi đang hoạt động, hành động này sẽ quay số như cho IVR.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-125">If the call is on an active call, this action would dial digits as if for an IVR.</span></span>|  
|<span data-ttu-id="4e2a1-126">Chuyển</span><span class="sxs-lookup"><span data-stu-id="4e2a1-126">Transfer</span></span>|<span data-ttu-id="4e2a1-127">Điều này sẽ bắt đầu hoặc hoàn tất việc chuyển giao.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-127">This would initiate or complete a transfer.</span></span> <span data-ttu-id="4e2a1-128">Nếu việc chuyển giao đã được bắt đầu nhưng chưa hoàn tất, điều này sẽ chuyển cuộc gọi và bỏ qua các tham số.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-128">If a transfer has been initiated but not completed, this would transfer the call and ignore the parameter.</span></span> <span data-ttu-id="4e2a1-129">Nếu cuộc gọi hiện hoạt là hiện tại, nó sẽ đặt giữ cuộc gọi và thực hiện cuộc gọi mới đi qua các dữ liệu ngữ cảnh.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-129">If an active call is present, it would place the call on hold and make a new call passing the context data.</span></span>|  
|<span data-ttu-id="4e2a1-130">Hội nghị</span><span class="sxs-lookup"><span data-stu-id="4e2a1-130">Conference</span></span>|<span data-ttu-id="4e2a1-131">Điều này sẽ bắt đầu hoặc hoàn tất hội nghị.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-131">This would initiate or complete a conference.</span></span> <span data-ttu-id="4e2a1-132">Nếu hội nghị đã được bắt đầu nhưng chưa hoàn tất, điều này sẽ chuyển hội nghị và bỏ qua các tham số.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-132">If a conference has been initiated but not completed, this would conference the call and ignore the parameter.</span></span> <span data-ttu-id="4e2a1-133">Nếu cuộc gọi hiện hoạt là hiện tại, nó sẽ đặt giữ cuộc gọi và thực hiện cuộc gọi mới đi qua các dữ liệu ngữ cảnh.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-133">If an active call is present, it would place the call on hold and make a new call passing the context data.</span></span>|  
|<span data-ttu-id="4e2a1-134">Gác máy</span><span class="sxs-lookup"><span data-stu-id="4e2a1-134">Hangup</span></span>|<span data-ttu-id="4e2a1-135">Điều này kết thúc cuộc gọi hiện tại.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-135">This ends the current call.</span></span>|  

> [!NOTE]
>  <span data-ttu-id="4e2a1-136">If these actions are supported by the **CTI Desktop Manager** hosted control, users will be able to trigger this functionality from a wide variety of locations within the application, thus providing a tightly integrated agent experience.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-136">If these actions are supported by the **CTI Desktop Manager** hosted control, users will be able to trigger this functionality from a wide variety of locations within the application, thus providing a tightly integrated agent experience.</span></span>  

<a name="CTIScreenPop"></a>   
## <a name="cti-screen-pop"></a><span data-ttu-id="4e2a1-137">CTI screen pop</span><span class="sxs-lookup"><span data-stu-id="4e2a1-137">CTI screen pop</span></span>  
 <span data-ttu-id="4e2a1-138">You must ensure the following while designing [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] screen pops in [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span><span class="sxs-lookup"><span data-stu-id="4e2a1-138">You must ensure the following while designing [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] screen pops in [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span></span>  

- <span data-ttu-id="4e2a1-139">The following values must be populated in the `CallInfo` parameter of the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)]request.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-139">The following values must be populated in the `CallInfo` parameter of the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)]request.</span></span>  


  | <span data-ttu-id="4e2a1-140">Tham số</span><span class="sxs-lookup"><span data-stu-id="4e2a1-140">Parameter</span></span> |                                                                                               <span data-ttu-id="4e2a1-141">Mô tả</span><span class="sxs-lookup"><span data-stu-id="4e2a1-141">Description</span></span>                                                                                               |
  |-----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
  | <span data-ttu-id="4e2a1-142">hướng</span><span class="sxs-lookup"><span data-stu-id="4e2a1-142">direction</span></span> | <span data-ttu-id="4e2a1-143">Specify “inbound” for incoming calls and “outbound” for outgoing calls.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-143">Specify “inbound” for incoming calls and “outbound” for outgoing calls.</span></span><br /><br /> <span data-ttu-id="4e2a1-144">Điều này được sử dụng bởi hệ thống để cho phép các quản trị viên xác định các hành vi khác nhau tùy thuộc vào sự hướng dẫn của các cuộc gọi.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-144">This is used by the system to allow the admin to specify different behavior depending on the direction of the call.</span></span> |
  | <span data-ttu-id="4e2a1-145">Loại cuộc gọi</span><span class="sxs-lookup"><span data-stu-id="4e2a1-145">Calltype</span></span>  |                                                                    <span data-ttu-id="4e2a1-146">Specify “phonecall” for voicecalls and “chat” for chat sessions..</span><span class="sxs-lookup"><span data-stu-id="4e2a1-146">Specify “phonecall” for voicecalls and “chat” for chat sessions..</span></span>                                                                    |


- [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] <span data-ttu-id="4e2a1-147">adapters should not automatically create activities in [!INCLUDE[pn_microsoftcrm](../includes/pn-microsoftcrm.md)] apps because this is not always the desired behavior.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-147">adapters should not automatically create activities in [!INCLUDE[pn_microsoftcrm](../includes/pn-microsoftcrm.md)] apps because this is not always the desired behavior.</span></span> <span data-ttu-id="4e2a1-148">Do đó, điều này nên được để lại cho các quản trị viên hệ thống định cấu hình.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-148">Therefore, this should be left for the system administrators to configure.</span></span>  

    ```csharp  
    try  
    {  
      FireRequestAction(new RequestActionEventArgs("*", CtiLookuprequest.CTILOOKUPACTIONNAME,GeneralFunctions.Serialize<CtiLookupRequest>(data)));  
    }  
    ```  

  > [!NOTE]
  >  <span data-ttu-id="4e2a1-149">It is assumed that the `CTILOOKUPACTIONNAME` be used for calling the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] action, and that the application name will be "\*", as shown in the example code.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-149">It is assumed that the `CTILOOKUPACTIONNAME` be used for calling the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] action, and that the application name will be "\*", as shown in the example code.</span></span>  

> [!IMPORTANT]
>  <span data-ttu-id="4e2a1-150">It is possible to create [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] adapters for [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] that don’t follow the [!INCLUDE[pn_user_inteface_integration_uii](../includes/pn-user-interface-integration-uii.md)][!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] framework.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-150">It is possible to create [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] adapters for [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] that don’t follow the [!INCLUDE[pn_user_inteface_integration_uii](../includes/pn-user-interface-integration-uii.md)][!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] framework.</span></span>  

<a name="CTISearch"></a>   
## <a name="cti-search"></a><span data-ttu-id="4e2a1-151">Tìm kiếm CTI</span><span class="sxs-lookup"><span data-stu-id="4e2a1-151">CTI search</span></span>  
 [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] <span data-ttu-id="4e2a1-152">searches are done using FetchXML in [!INCLUDE[pn_crm_shortest](../includes/pn-crm-shortest.md)] apps.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-152">searches are done using FetchXML in [!INCLUDE[pn_crm_shortest](../includes/pn-crm-shortest.md)] apps.</span></span> <span data-ttu-id="4e2a1-153">You can search using any data passed in any parameter from [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] against any field in your entity of choice in Dynamics 365 for Customer Engagement apps.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-153">You can search using any data passed in any parameter from [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] against any field in your entity of choice in Dynamics 365 for Customer Engagement apps.</span></span> <span data-ttu-id="4e2a1-154">Tìm kiếm được thực hiện một quy tắc tại một thời điểm tìm thấy kết quả khớp.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-154">Searches are performed one rule at a time until a match is found.</span></span> <span data-ttu-id="4e2a1-155">Khi khớp với quy tắc điều hướng cửa sổ trong [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] được tìm thấy, nó sẽ làm theo sự hướng dẫn cấu hình trong quy tắc chuyển hướng cho bước tiếp theo.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-155">Once a match to a window navigation rule in [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] is found, it will follow the guidance configured in the navigation rule for the next step.</span></span> <span data-ttu-id="4e2a1-156">Typically, a rule is set up to open a session around the activity, and optionally display the activity in a tab. For more information about how to configure a window navigation rule to perform a [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)]search, see [Walkthrough: Use generic listener adapter for CTI events](../unified-service-desk/walkthrough-use-the-generic-listener-adapter-for-cti-event-routing.md).</span><span class="sxs-lookup"><span data-stu-id="4e2a1-156">Typically, a rule is set up to open a session around the activity, and optionally display the activity in a tab. For more information about how to configure a window navigation rule to perform a [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)]search, see [Walkthrough: Use generic listener adapter for CTI events](../unified-service-desk/walkthrough-use-the-generic-listener-adapter-for-cti-event-routing.md).</span></span>  

 <span data-ttu-id="4e2a1-157">Chúng ta hãy đặt cấu hình quy tắc tìm CTI mẫu bằng cách sử dụng quy tắc chuyển hướng cửa sổ trong [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span><span class="sxs-lookup"><span data-stu-id="4e2a1-157">Let us configure a sample CTI search rule using the window navigation rule in [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)].</span></span> <span data-ttu-id="4e2a1-158">For more information about the window navigation rule, see [Use window navigation rules in Unified Service Desk](../unified-service-desk/use-window-navigation-rules-unified-service-desk.md).</span><span class="sxs-lookup"><span data-stu-id="4e2a1-158">For more information about the window navigation rule, see [Use window navigation rules in Unified Service Desk](../unified-service-desk/use-window-navigation-rules-unified-service-desk.md).</span></span>  

1. <span data-ttu-id="4e2a1-159">Trên thanh điều hướng, chọn **Microsoft Dynamics 365 for Customer Engagement** và chọn **Thiết đặt**.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-159">On the nav bar, choose **Microsoft Dynamics 365 for Customer Engagement**, and then select **Settings**.</span></span>  

2. <span data-ttu-id="4e2a1-160">On the nav bar, choose **Settings**, and then select **Window Navigation Rules**.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-160">On the nav bar, choose **Settings**, and then select **Window Navigation Rules**.</span></span>  

3. <span data-ttu-id="4e2a1-161">Chọn **Mới**.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-161">Choose **New**.</span></span>  

4. <span data-ttu-id="4e2a1-162">Nhập tên và thứ tự cho quy tắc điều hướng cửa sổ.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-162">Type a name and order for the window navigation rule.</span></span> <span data-ttu-id="4e2a1-163">In the **From** box, select your [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-163">In the **From** box, select your [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control.</span></span>  

5. <span data-ttu-id="4e2a1-164">After you have selected your [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager, the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] options will be displayed starting with an initiating activity.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-164">After you have selected your [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager, the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] options will be displayed starting with an initiating activity.</span></span> <span data-ttu-id="4e2a1-165">The initiating activity field should contain the entity type passed from the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] adapter.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-165">The initiating activity field should contain the entity type passed from the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] adapter.</span></span> <span data-ttu-id="4e2a1-166">For example, it can be phonecall, chat, email, and so on.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-166">For example, it can be phonecall, chat, email, and so on.</span></span> <span data-ttu-id="4e2a1-167">Một quy tắc chỉ xử lý một loại hoạt động từ các máy chủ CTI.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-167">One rule only handles one type of activity from the CTI server.</span></span>  

   <span data-ttu-id="4e2a1-168">![New window navigation rule for routing CTI event](../unified-service-desk/media/usd-cti-route-rule.png "New window navigation rule for routing CTI event")</span><span class="sxs-lookup"><span data-stu-id="4e2a1-168">![New window navigation rule for routing CTI event](../unified-service-desk/media/usd-cti-route-rule.png "New window navigation rule for routing CTI event")</span></span>  

6. <span data-ttu-id="4e2a1-169">Bấm vào **Lưu** ở góc dưới bên phải để lưu hồ sơ và cho phép các trường cần thiết cho các bước tiếp theo.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-169">Click **Save** in the lower-right corner to save the record, and enable the fields required for the next steps.</span></span>  

7. <span data-ttu-id="4e2a1-170">Trong **Tìm kiếm CTI**, nhấp vào biểu tượng tìm kiếm, và sau đó nhấp vào **Mới** trong hộp tìm kiếm để xác định một tiêu chí tìm kiếm mới bằng cách sử dụng các truy vấn FetchXML.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-170">Under **CTI Searches**, click the search icon, and then click **New** in the search box to define a new search criteria using the FetchXML query.</span></span>  

8. <span data-ttu-id="4e2a1-171">Trong màn hình **Tìm kiếm CTI mới**, chỉ định tên và trình tự cho truy vấn tìm kiếm của CTI.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-171">In the **New CTI Search** screen, specify a name and order for the CTI search query.</span></span> <span data-ttu-id="4e2a1-172">The direction field is Inbound or Outbound and is used to search against only a specific direction of CTI event.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-172">The direction field is Inbound or Outbound and is used to search against only a specific direction of CTI event.</span></span> <span data-ttu-id="4e2a1-173">This direction is passed from the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] adapter.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-173">This direction is passed from the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] adapter.</span></span>  

    <span data-ttu-id="4e2a1-174">Enter the required FetchXML query for the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] search.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-174">Enter the required FetchXML query for the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] search.</span></span> <span data-ttu-id="4e2a1-175">Use the advanced find feature in [!INCLUDE[pn_crm_shortest](../includes/pn-crm-shortest.md)] apps to create your initial search, and then download the FetchXML.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-175">Use the advanced find feature in [!INCLUDE[pn_crm_shortest](../includes/pn-crm-shortest.md)] apps to create your initial search, and then download the FetchXML.</span></span> <span data-ttu-id="4e2a1-176">The key field is often not available in the [!INCLUDE[pn_microsoftcrm](../includes/pn-microsoftcrm.md)] apps Advanced Find search, so you may find that you need to add that condition manually to the XML after you have exported it.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-176">The key field is often not available in the [!INCLUDE[pn_microsoftcrm](../includes/pn-microsoftcrm.md)] apps Advanced Find search, so you may find that you need to add that condition manually to the XML after you have exported it.</span></span> <span data-ttu-id="4e2a1-177">You should also select the attributes that you’re interested to show up in the [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] context.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-177">You should also select the attributes that you’re interested to show up in the [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] context.</span></span> <span data-ttu-id="4e2a1-178">Các thuộc tính này hiển thị ngay lập tức thay vì được xác định sau khi tải trang trong màn hình như các loại dữ liệu thông số khác.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-178">These show up immediately rather than be populated after pages load in the display like the other types of data parameters.</span></span> <span data-ttu-id="4e2a1-179">Once you have the FetchXML you want, paste the text into the **FetchXML** box, and save the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] search rule.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-179">Once you have the FetchXML you want, paste the text into the **FetchXML** box, and save the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] search rule.</span></span>  

   <span data-ttu-id="4e2a1-180">![New CTI search in Unified Service Desk](../unified-service-desk/media/usd-cti-search-rule-2.PNG "New CTI search in Unified Service Desk")</span><span class="sxs-lookup"><span data-stu-id="4e2a1-180">![New CTI search in Unified Service Desk](../unified-service-desk/media/usd-cti-search-rule-2.PNG "New CTI search in Unified Service Desk")</span></span>  

9. <span data-ttu-id="4e2a1-181">The system will search each of your [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] search items for the rule.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-181">The system will search each of your [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] search items for the rule.</span></span> <span data-ttu-id="4e2a1-182">Điều này có thể được dùng như một thực thể qua tìm kiếm.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-182">This can be thought of like a cross entity search.</span></span> <span data-ttu-id="4e2a1-183">The conditions relate to the final result set and may, in the case of multiple results handling, indicate that one or more records were found from more than one entity type.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-183">The conditions relate to the final result set and may, in the case of multiple results handling, indicate that one or more records were found from more than one entity type.</span></span>  

     <span data-ttu-id="4e2a1-184">Below the search list are three conditions and selections used to indicate what is to be done in each case.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-184">Below the search list are three conditions and selections used to indicate what is to be done in each case.</span></span>  

    |<span data-ttu-id="4e2a1-185">Điều kiện</span><span class="sxs-lookup"><span data-stu-id="4e2a1-185">Condition</span></span>|<span data-ttu-id="4e2a1-186">Mô tả</span><span class="sxs-lookup"><span data-stu-id="4e2a1-186">Description</span></span>|  
    |---------------|-----------------|  
    |<span data-ttu-id="4e2a1-187">Không có kết quả phù hợp</span><span class="sxs-lookup"><span data-stu-id="4e2a1-187">No Matches</span></span>|<span data-ttu-id="4e2a1-188">What should the system do if no matches were found across all the searches specified in the rule.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-188">What should the system do if no matches were found across all the searches specified in the rule.</span></span>|  
    |<span data-ttu-id="4e2a1-189">Một kết quả phù hợp</span><span class="sxs-lookup"><span data-stu-id="4e2a1-189">Single Match</span></span>|<span data-ttu-id="4e2a1-190">Hệ thống sẽ làm gì khi chỉ tìm thấy một hồ sơ cho kết quả tìm kiếm kết hợp.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-190">What should the system do when only one record is found as a result of the combined searches.</span></span>|  
    |<span data-ttu-id="4e2a1-191">Nhiều kết quả phù hợp</span><span class="sxs-lookup"><span data-stu-id="4e2a1-191">Multiple Matches</span></span>|<span data-ttu-id="4e2a1-192">Hệ thống sẽ làm gì nếu có nhiều hơn một kết quả được tìm thấy trên tất cả các tìm kiếm.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-192">What should the system do if more than one result was found across all the searches.</span></span>|  

     <span data-ttu-id="4e2a1-193">Đối với mỗi điều kiện, cần đưa ra một quyết định liên quan đến việc phải làm gì.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-193">For each condition, there is a decision to be made regarding what to do.</span></span>  


   |                 <span data-ttu-id="4e2a1-194">Quyết định</span><span class="sxs-lookup"><span data-stu-id="4e2a1-194">Decision</span></span>                  |                                                                                                                                                                           <span data-ttu-id="4e2a1-195">Mô tả</span><span class="sxs-lookup"><span data-stu-id="4e2a1-195">Description</span></span>                                                                                                                                                                            |
   |-------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |       <span data-ttu-id="4e2a1-196">Tạo phiên sau đó Thực hiện hành động</span><span class="sxs-lookup"><span data-stu-id="4e2a1-196">Create Session then Do Action</span></span>       |                                                                                                                    <span data-ttu-id="4e2a1-197">Creates a new session before firing a configured action.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-197">Creates a new session before firing a configured action.</span></span> <span data-ttu-id="4e2a1-198">Hành động này sẽ được bắt đầu trong ngữ cảnh của phiên mới này.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-198">This action will be fired within the context of this new session.</span></span>                                                                                                                    |
   | <span data-ttu-id="4e2a1-199">Tạo phiên, tải kết quả phù hợp sau đó Thực hiện hành động</span><span class="sxs-lookup"><span data-stu-id="4e2a1-199">Create Session, Load Match then Do Action</span></span> |                                                 <span data-ttu-id="4e2a1-200">Creates a session, then loads the match into a tab or Entity Search based upon the selection in the Result Tab of the [!INCLUDE[pn_microsoftcrm](../includes/pn-microsoftcrm.md)] apps form.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-200">Creates a session, then loads the match into a tab or Entity Search based upon the selection in the Result Tab of the [!INCLUDE[pn_microsoftcrm](../includes/pn-microsoftcrm.md)] apps form.</span></span> <span data-ttu-id="4e2a1-201">Finally, it calls an action.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-201">Finally, it calls an action.</span></span> <span data-ttu-id="4e2a1-202">Tùy chọn này chỉ có hiệu lực cho một kết quả phù hợp.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-202">This option is only valid for single match.</span></span>                                                 |
   |                 <span data-ttu-id="4e2a1-203">Thực hiện Hành động</span><span class="sxs-lookup"><span data-stu-id="4e2a1-203">Do Action</span></span>                 | <span data-ttu-id="4e2a1-204">Tells the system to do nothing with the result, but optionally call a configured action specific to this condition.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-204">Tells the system to do nothing with the result, but optionally call a configured action specific to this condition.</span></span> <span data-ttu-id="4e2a1-205">You can call the `FireEvent` action on Global Manager hosted control, if you want to call multiple actions in sequence as a result of this.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-205">You can call the `FireEvent` action on Global Manager hosted control, if you want to call multiple actions in sequence as a result of this.</span></span> <span data-ttu-id="4e2a1-206">Hành động này sẽ được bắt đầu trong ngữ cảnh của phiên hiện tại.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-206">This action will be fired in the context of the current session.</span></span> <span data-ttu-id="4e2a1-207">Không có phiên làm việc mới được tạo ra.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-207">No new session will be created.</span></span> |
   |                 <span data-ttu-id="4e2a1-208">Nguyên tắc tiếp theo</span><span class="sxs-lookup"><span data-stu-id="4e2a1-208">Next Rule</span></span>                 |                                                                                              <span data-ttu-id="4e2a1-209">Cho hệ thống biết bỏ qua phần còn lại của việc xử lý quy tắc này và để tìm kiếm các quy tắc có thể phù hợp khác.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-209">Tells the system to ignore the rest of the processing of this rule and to look for other rules that may match.</span></span> <span data-ttu-id="4e2a1-210">Tìm kiếm mới sẽ được thực hiện chống lại quy tắc tiếp theo.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-210">New searches will be performed against subsequent rule.</span></span>                                                                                              |

    > [!IMPORTANT]
    >  <span data-ttu-id="4e2a1-211">Bất kỳ thời điểm nào hệ thống không có tùy chọn "Quy tắc Tiếp theo" được cấu hình trong các quy tắc chuyển hướng của bạn, nó cũng sẽ thực hiện các hành động được cấu hình trên quy tắc chuyển hướng của chính nó.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-211">Any time the system does not take the “Next Rule” option configured in your navigation rule, it will also execute the configured actions on the navigation rule itself.</span></span> <span data-ttu-id="4e2a1-212">Nếu bạn muốn chỉ thực hiện quy tắc trong trường hợp cụ thể, bạn nên sử dụng các hành động trong phần đó.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-212">If you want to execute rules only in specific cases, you should use the action in that section.</span></span> <span data-ttu-id="4e2a1-213">Vì hành động có mục đích chung mà nên thực hiện cho dù có đưa ra sự lựa chọn nào, bạn có thể nhập chúng vào danh sách hoạt động cho quy tắc điều hướng.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-213">For general purpose actions, that should execute regardless of which choice is made, you might enter them in the actions list for the navigation rule.</span></span>  

<a name="chat"></a>   
## <a name="special-features-of-chat-events"></a><span data-ttu-id="4e2a1-214">Các tính năng đặc biệt của sự kiện trò chuyện</span><span class="sxs-lookup"><span data-stu-id="4e2a1-214">Special features of chat events</span></span>  
 <span data-ttu-id="4e2a1-215">Khi đáp ứng với sự kiện trò chuyện, một số điều đặc biệt diễn ra trong hệ thống.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-215">When responding to chat events, some special things occur in the system.</span></span> <span data-ttu-id="4e2a1-216">It is assumed that the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] event data parameter “`CTIDESKTOPMANAGERCONTROL`” value is populated with the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control name and it supports the `SendIM` action.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-216">It is assumed that the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] event data parameter “`CTIDESKTOPMANAGERCONTROL`” value is populated with the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control name and it supports the `SendIM` action.</span></span> <span data-ttu-id="4e2a1-217">If the [CALLTYPE](https://docs.microsoft.com/dotnet/api/microsoft.uii.desktop.cti.core.lookuprequestkeys.calltype) passed into the [CtiLookupRequest](https://docs.microsoft.com/dotnet/api/microsoft.uii.desktop.cti.core.ctilookuprequest) is “Chat”, [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] will show an extra button on the agent scripting user interface.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-217">If the [CALLTYPE](https://docs.microsoft.com/dotnet/api/microsoft.uii.desktop.cti.core.lookuprequestkeys.calltype) passed into the [CtiLookupRequest](https://docs.microsoft.com/dotnet/api/microsoft.uii.desktop.cti.core.ctilookuprequest) is “Chat”, [!INCLUDE[pn_unified_service_desk](../includes/pn-unified-service-desk.md)] will show an extra button on the agent scripting user interface.</span></span> <span data-ttu-id="4e2a1-218">If the agent clicks this button, it will attempt to invoke the `SendIM` action on the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control specified in the `CTIDESKTOPMANAGERCONTROL` control.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-218">If the agent clicks this button, it will attempt to invoke the `SendIM` action on the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control specified in the `CTIDESKTOPMANAGERCONTROL` control.</span></span> <span data-ttu-id="4e2a1-219">It will pass the text of the agent script to this action, and it is assumed that the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control will write this text to the chat output.</span><span class="sxs-lookup"><span data-stu-id="4e2a1-219">It will pass the text of the agent script to this action, and it is assumed that the [!INCLUDE[pn_cti_acronym](../includes/pn-cti-acronym.md)] Desktop Manager hosted control will write this text to the chat output.</span></span>  

### <a name="see-also"></a><span data-ttu-id="4e2a1-220">Xem thêm</span><span class="sxs-lookup"><span data-stu-id="4e2a1-220">See also</span></span>  
 <span data-ttu-id="4e2a1-221">[UII Computer Telephony Integration (CTI) framework](../unified-service-desk/uii-computer-telephony-integration-cti-framework.md) </span><span class="sxs-lookup"><span data-stu-id="4e2a1-221">[UII Computer Telephony Integration (CTI) framework](../unified-service-desk/uii-computer-telephony-integration-cti-framework.md) </span></span>  
 <span data-ttu-id="4e2a1-222">[CTIDESKTOPMANAGERCONTROL](https://docs.microsoft.com/dotnet/api/microsoft.uii.desktop.cti.core.lookuprequestkeys.ctidesktopmanagercontrol) </span><span class="sxs-lookup"><span data-stu-id="4e2a1-222">[CTIDESKTOPMANAGERCONTROL](https://docs.microsoft.com/dotnet/api/microsoft.uii.desktop.cti.core.lookuprequestkeys.ctidesktopmanagercontrol) </span></span>  
 <span data-ttu-id="4e2a1-223">[Create a CTI Desktop Manager](../unified-service-desk/create-cti-desktop-manager.md) </span><span class="sxs-lookup"><span data-stu-id="4e2a1-223">[Create a CTI Desktop Manager](../unified-service-desk/create-cti-desktop-manager.md) </span></span>  
 <span data-ttu-id="4e2a1-224">[Sử dụng quy tắc điều hướng cửa sổ trong Unified Service Desk](../unified-service-desk/use-window-navigation-rules-unified-service-desk.md) </span><span class="sxs-lookup"><span data-stu-id="4e2a1-224">[Use window navigation rules in Unified Service Desk](../unified-service-desk/use-window-navigation-rules-unified-service-desk.md) </span></span>  
 [<span data-ttu-id="4e2a1-225">Walkthrough: Use generic listener adapter for CTI events</span><span class="sxs-lookup"><span data-stu-id="4e2a1-225">Walkthrough: Use generic listener adapter for CTI events</span></span>](../unified-service-desk/walkthrough-use-the-generic-listener-adapter-for-cti-event-routing.md)
